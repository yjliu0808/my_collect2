
<!-- saved from url=(0081)http://tts.tmooc.cn/ttsPage/TESTING/TSDTN201801/SELENIUM/DAY04/CASE/01/index.html -->
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>CASE</title>
    
    <script type="text/javascript" src="./TEST SELENIUM DAY04_w_files/jquery.min.js">
    </script>
    <script type="text/javascript" src="./TEST SELENIUM DAY04_w_files/jquery.snippet.js">
    </script>
    <script type="text/javascript" src="./TEST SELENIUM DAY04_w_files/main.js">
    </script>
    <link type="text/css" href="./TEST SELENIUM DAY04_w_files/index.css" rel="Stylesheet">
    <link type="text/css" href="./TEST SELENIUM DAY04_w_files/jquery.snippet.css" rel="Stylesheet">
  </head>
  <body>
    <div class="source_style_case">
      <a name="page_top_case" id="top_anchor">
      </a><a id="link_top" href="http://tts.tmooc.cn/ttsPage/TESTING/TSDTN201801/SELENIUM/DAY04/CASE/01/index.html#page_top_case">Top</a>
      <h1>TEST SELENIUM DAY04</h1>
      <ol class="index">
        <li>
          <a href="http://tts.tmooc.cn/ttsPage/TESTING/TSDTN201801/SELENIUM/DAY04/CASE/01/index.html#case1">Chrome测试留言簿</a>
        </li>
        <li>
          <a href="http://tts.tmooc.cn/ttsPage/TESTING/TSDTN201801/SELENIUM/DAY04/CASE/01/index.html#case2">IE测试留言簿</a>
        </li>
        <li>
          <a href="http://tts.tmooc.cn/ttsPage/TESTING/TSDTN201801/SELENIUM/DAY04/CASE/01/index.html#case3">ECShop前台搜索</a>
        </li>
      </ol>
      <a name="case1">
      </a>
      <h2>1 Chrome测试留言簿</h2>
      <h3>1.1 问题</h3>
      <p>使用Chrome浏览器测试留言簿(example目录下的message.html程序)，需要实现在留言簿的被测系统中，完成如下操作的步骤：</p>
      <p>（1）在“名字”文本框中输入数据“jack”；</p>
      <p>（2）在“e-mail”文本框中输入数据“jack@163.com”；</p>
      <p>（3）在“留言”文本框中输入数据“Hello,jack!”；</p>
      <p>（4）点击“完成”按钮；</p>
      <p>（5）断言当前网页的标题等于“留言簿”；</p>
      <p>（6）断言“完成”按钮上的文字正确。</p>
      <h3>1.2 方案</h3>
      <p>本案例针对留言簿程序的操作步骤和前面day03的案例（Firefox测试留言簿）要求相同，只是使用的浏览器换为Chrome而已，所以我们可以直接复制前面的案例的类（FirefoxMessage1.java）；</p>
      <p>Chrome浏览器是由Google开发的一款设计简单、高效的Web浏览工具。</p>
      <p>首先，需要准备Chrome的驱动文件，安装Chrome浏览器；</p>
      <p>其次，需要在新复制的类中修改启动浏览器的步骤为启动Chrome浏览器，指定相应的浏览器驱动文件，导入相应的类。</p>
      <p>最后，需要运行整个JUnit测试用例或来查看结果。</p>
      <h3>1.3 步骤</h3>
      <p>实现此案例需要按照如下步骤进行。</p>
      <p class="number">步骤一：复制上一案例的JUnit类代码</p>
      <p>在Project1的day03的package下，选中上一案例（Firefox测试留言簿）完成的JUnit类（FirefoxMessage1.java）,使用右键菜单Copy或者快捷键Ctrl+C来复制类文件；新建day04的package，点击选中day04包后，使用右键菜单Paste或Ctrl+V来粘贴该文件，选中该文件后，使用F2快捷键，修改类名为ChromeMessage，点击”Finish“按钮，如下图-1所示：</p>
      <div class="image">
        <img src="./TEST SELENIUM DAY04_w_files/image001.png">
        <p>图 - 1</p>
      </div>
      <p>ChromeMessage.java的代码如下所示：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/TESTING/TSDTN201801/SELENIUM/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/TESTING/TSDTN201801/SELENIUM/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/TESTING/TSDTN201801/SELENIUM/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li>package day04<span class="sh_symbol">;</span></li><li><span style="display:none;">&nbsp;</span></li><li>import java<span class="sh_symbol">.</span>util<span class="sh_symbol">.</span>regex<span class="sh_symbol">.</span>Pattern<span class="sh_symbol">;</span></li><li>import java<span class="sh_symbol">.</span>util<span class="sh_symbol">.</span>concurrent<span class="sh_symbol">.</span>TimeUnit<span class="sh_symbol">;</span></li><li>import org<span class="sh_symbol">.</span>junit<span class="sh_symbol">.*;</span></li><li>import <span class="sh_keyword">static</span> org<span class="sh_symbol">.</span>junit<span class="sh_symbol">.</span>Assert<span class="sh_symbol">.*;</span></li><li>import <span class="sh_keyword">static</span> org<span class="sh_symbol">.</span>hamcrest<span class="sh_symbol">.</span>CoreMatchers<span class="sh_symbol">.*;</span></li><li>import org<span class="sh_symbol">.</span>openqa<span class="sh_symbol">.</span>selenium<span class="sh_symbol">.*;</span></li><li>import org<span class="sh_symbol">.</span>openqa<span class="sh_symbol">.</span>selenium<span class="sh_symbol">.</span>firefox<span class="sh_symbol">.</span>FirefoxDriver<span class="sh_symbol">;</span></li><li>import org<span class="sh_symbol">.</span>openqa<span class="sh_symbol">.</span>selenium<span class="sh_symbol">.</span>support<span class="sh_symbol">.</span>ui<span class="sh_symbol">.</span>Select<span class="sh_symbol">;</span></li><li><span style="display:none;">&nbsp;</span></li><li><span class="sh_keyword">public</span> <span class="sh_keyword">class</span> ChromeMessage <span class="sh_cbracket">{</span></li><li>  <span class="sh_keyword">private</span> WebDriver driver<span class="sh_symbol">;</span></li><li>  <span class="sh_keyword">private</span> <span class="sh_predef_func">String</span> baseUrl<span class="sh_symbol">;</span></li><li>  <span class="sh_keyword">private</span> boolean acceptNextAlert <span class="sh_symbol">=</span> <span class="sh_keyword">true</span><span class="sh_symbol">;</span></li><li>  <span class="sh_keyword">private</span> StringBuffer verificationErrors <span class="sh_symbol">=</span> <span class="sh_keyword">new</span> <span class="sh_function">StringBuffer</span><span class="sh_symbol">();</span></li><li><span style="display:none;">&nbsp;</span></li><li>  @Before</li><li>  <span class="sh_keyword">public</span> void <span class="sh_function">setUp</span><span class="sh_symbol">()</span> <span class="sh_keyword">throws</span> Exception <span class="sh_cbracket">{</span></li><li>    driver <span class="sh_symbol">=</span> <span class="sh_keyword">new</span> <span class="sh_function">FirefoxDriver</span><span class="sh_symbol">();</span></li><li>    baseUrl <span class="sh_symbol">=</span> <span class="sh_string">"http://localhost/"</span><span class="sh_symbol">;</span></li><li>    driver<span class="sh_symbol">.</span><span class="sh_function">manage</span><span class="sh_symbol">().</span><span class="sh_function">timeouts</span><span class="sh_symbol">().</span><span class="sh_function">implicitlyWait</span><span class="sh_symbol">(</span><span class="sh_number">30</span><span class="sh_symbol">,</span> TimeUnit<span class="sh_symbol">.</span>SECONDS<span class="sh_symbol">);</span></li><li>  <span class="sh_cbracket">}</span></li><li><span style="display:none;">&nbsp;</span></li><li>  @Test</li><li>  <span class="sh_keyword">public</span> void <span class="sh_function">testUntitled</span><span class="sh_symbol">()</span> <span class="sh_keyword">throws</span> Exception <span class="sh_cbracket">{</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//因为是绝对路径的url，所以删除baseUrl+的部分</span></li><li>    driver<span class="sh_symbol">.</span><span class="sh_function">get</span><span class="sh_symbol">(</span><span class="sh_string">"file:///E:/Selenium/example/message.html"</span><span class="sh_symbol">);</span></li><li>    driver<span class="sh_symbol">.</span><span class="sh_function">findElement</span><span class="sh_symbol">(</span>By<span class="sh_symbol">.</span><span class="sh_function">name</span><span class="sh_symbol">(</span><span class="sh_string">"name"</span><span class="sh_symbol">)).</span><span class="sh_function">clear</span><span class="sh_symbol">();</span></li><li>    driver<span class="sh_symbol">.</span><span class="sh_function">findElement</span><span class="sh_symbol">(</span>By<span class="sh_symbol">.</span><span class="sh_function">name</span><span class="sh_symbol">(</span><span class="sh_string">"name"</span><span class="sh_symbol">)).</span><span class="sh_function">sendKeys</span><span class="sh_symbol">(</span><span class="sh_string">"jack"</span><span class="sh_symbol">);</span></li><li>    driver<span class="sh_symbol">.</span><span class="sh_function">findElement</span><span class="sh_symbol">(</span>By<span class="sh_symbol">.</span><span class="sh_function">name</span><span class="sh_symbol">(</span><span class="sh_string">"e-mail"</span><span class="sh_symbol">)).</span><span class="sh_function">clear</span><span class="sh_symbol">();</span></li><li>    driver<span class="sh_symbol">.</span><span class="sh_function">findElement</span><span class="sh_symbol">(</span>By<span class="sh_symbol">.</span><span class="sh_function">name</span><span class="sh_symbol">(</span><span class="sh_string">"e-mail"</span><span class="sh_symbol">)).</span><span class="sh_function">sendKeys</span><span class="sh_symbol">(</span><span class="sh_string">"jack@163.com"</span><span class="sh_symbol">);</span></li><li>    driver<span class="sh_symbol">.</span><span class="sh_function">findElement</span><span class="sh_symbol">(</span>By<span class="sh_symbol">.</span><span class="sh_function">name</span><span class="sh_symbol">(</span><span class="sh_string">"comments"</span><span class="sh_symbol">)).</span><span class="sh_function">clear</span><span class="sh_symbol">();</span></li><li>    driver<span class="sh_symbol">.</span><span class="sh_function">findElement</span><span class="sh_symbol">(</span>By<span class="sh_symbol">.</span><span class="sh_function">name</span><span class="sh_symbol">(</span><span class="sh_string">"comments"</span><span class="sh_symbol">)).</span><span class="sh_function">sendKeys</span><span class="sh_symbol">(</span><span class="sh_string">"Hello,jack!"</span><span class="sh_symbol">);</span></li><li>    driver<span class="sh_symbol">.</span><span class="sh_function">findElement</span><span class="sh_symbol">(</span>By<span class="sh_symbol">.</span><span class="sh_function">cssSelector</span><span class="sh_symbol">(</span><span class="sh_string">"input[type=</span><span class="sh_specialchar">\"</span><span class="sh_string">submit</span><span class="sh_specialchar">\"</span><span class="sh_string">]"</span><span class="sh_symbol">)).</span><span class="sh_function">click</span><span class="sh_symbol">();</span></li><li>    <span class="sh_function">assertEquals</span><span class="sh_symbol">(</span><span class="sh_string">"留言簿"</span><span class="sh_symbol">,</span> driver<span class="sh_symbol">.</span><span class="sh_function">getTitle</span><span class="sh_symbol">());</span></li><li>    <span class="sh_function">assertEquals</span><span class="sh_symbol">(</span><span class="sh_string">"完 成"</span><span class="sh_symbol">,</span> driver<span class="sh_symbol">.</span><span class="sh_function">findElement</span><span class="sh_symbol">(</span>By<span class="sh_symbol">.</span><span class="sh_function">cssSelector</span><span class="sh_symbol">(</span><span class="sh_string">"input[type=</span><span class="sh_specialchar">\"</span><span class="sh_string">submit</span><span class="sh_specialchar">\"</span><span class="sh_string">]"</span><span class="sh_symbol">)).</span><span class="sh_function">getAttribute</span><span class="sh_symbol">(</span><span class="sh_string">"value"</span><span class="sh_symbol">));</span></li><li>  <span class="sh_cbracket">}</span></li><li><span style="display:none;">&nbsp;</span></li><li>  @After</li><li>  <span class="sh_keyword">public</span> void <span class="sh_function">tearDown</span><span class="sh_symbol">()</span> <span class="sh_keyword">throws</span> Exception <span class="sh_cbracket">{</span></li><li>    driver<span class="sh_symbol">.</span><span class="sh_function">quit</span><span class="sh_symbol">();</span></li><li>    <span class="sh_predef_func">String</span> verificationErrorString <span class="sh_symbol">=</span> verificationErrors<span class="sh_symbol">.</span><span class="sh_function">toString</span><span class="sh_symbol">();</span></li><li>    <span class="sh_keyword">if</span> <span class="sh_symbol">(!</span><span class="sh_string">""</span><span class="sh_symbol">.</span><span class="sh_function">equals</span><span class="sh_symbol">(</span>verificationErrorString<span class="sh_symbol">))</span> <span class="sh_cbracket">{</span></li><li>      <span class="sh_function">fail</span><span class="sh_symbol">(</span>verificationErrorString<span class="sh_symbol">);</span></li><li>    <span class="sh_cbracket">}</span></li><li>  <span class="sh_cbracket">}</span></li><li><span style="display:none;">&nbsp;</span></li><li>  <span class="sh_keyword">private</span> boolean <span class="sh_function">isElementPresent</span><span class="sh_symbol">(</span>By by<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span></li><li>    <span class="sh_keyword">try</span> <span class="sh_cbracket">{</span></li><li>      driver<span class="sh_symbol">.</span><span class="sh_function">findElement</span><span class="sh_symbol">(</span>by<span class="sh_symbol">);</span></li><li>      <span class="sh_keyword">return</span> <span class="sh_keyword">true</span><span class="sh_symbol">;</span></li><li>    <span class="sh_cbracket">}</span> <span class="sh_keyword">catch</span> <span class="sh_symbol">(</span>NoSuchElementException e<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span></li><li>      <span class="sh_keyword">return</span> <span class="sh_keyword">false</span><span class="sh_symbol">;</span></li><li>    <span class="sh_cbracket">}</span></li><li>  <span class="sh_cbracket">}</span></li><li><span style="display:none;">&nbsp;</span></li><li>  <span class="sh_keyword">private</span> boolean <span class="sh_function">isAlertPresent</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span></li><li>    <span class="sh_keyword">try</span> <span class="sh_cbracket">{</span></li><li>      driver<span class="sh_symbol">.</span><span class="sh_function">switchTo</span><span class="sh_symbol">().</span><span class="sh_function">alert</span><span class="sh_symbol">();</span></li><li>      <span class="sh_keyword">return</span> <span class="sh_keyword">true</span><span class="sh_symbol">;</span></li><li>    <span class="sh_cbracket">}</span> <span class="sh_keyword">catch</span> <span class="sh_symbol">(</span>NoAlertPresentException e<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span></li><li>      <span class="sh_keyword">return</span> <span class="sh_keyword">false</span><span class="sh_symbol">;</span></li><li>    <span class="sh_cbracket">}</span></li><li>  <span class="sh_cbracket">}</span></li><li><span style="display:none;">&nbsp;</span></li><li>  <span class="sh_keyword">private</span> <span class="sh_predef_func">String</span> <span class="sh_function">closeAlertAndGetItsText</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span></li><li>    <span class="sh_keyword">try</span> <span class="sh_cbracket">{</span></li><li>      Alert alert <span class="sh_symbol">=</span> driver<span class="sh_symbol">.</span><span class="sh_function">switchTo</span><span class="sh_symbol">().</span><span class="sh_function">alert</span><span class="sh_symbol">();</span></li><li>      <span class="sh_predef_func">String</span> alertText <span class="sh_symbol">=</span> alert<span class="sh_symbol">.</span><span class="sh_function">getText</span><span class="sh_symbol">();</span></li><li>      <span class="sh_keyword">if</span> <span class="sh_symbol">(</span>acceptNextAlert<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span></li><li>        alert<span class="sh_symbol">.</span><span class="sh_function">accept</span><span class="sh_symbol">();</span></li><li>      <span class="sh_cbracket">}</span> <span class="sh_keyword">else</span> <span class="sh_cbracket">{</span></li><li>        alert<span class="sh_symbol">.</span><span class="sh_function">dismiss</span><span class="sh_symbol">();</span></li><li>      <span class="sh_cbracket">}</span></li><li>      <span class="sh_keyword">return</span> alertText<span class="sh_symbol">;</span></li><li>    <span class="sh_cbracket">}</span> <span class="sh_keyword">finally</span> <span class="sh_cbracket">{</span></li><li>      acceptNextAlert <span class="sh_symbol">=</span> <span class="sh_keyword">true</span><span class="sh_symbol">;</span></li><li>    <span class="sh_cbracket">}</span></li><li>  <span class="sh_cbracket">}</span></li><li><span class="sh_cbracket">}</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">package day04;

import java.util.regex.Pattern;
import java.util.concurrent.TimeUnit;
import org.junit.*;
import static org.junit.Assert.*;
import static org.hamcrest.CoreMatchers.*;
import org.openqa.selenium.*;
import org.openqa.selenium.firefox.FirefoxDriver;
import org.openqa.selenium.support.ui.Select;

public class ChromeMessage {
  private WebDriver driver;
  private String baseUrl;
  private boolean acceptNextAlert = true;
  private StringBuffer verificationErrors = new StringBuffer();

  @Before
  public void setUp() throws Exception {
    driver = new FirefoxDriver();
    baseUrl = "http://localhost/";
    driver.manage().timeouts().implicitlyWait(30, TimeUnit.SECONDS);
  }

  @Test
  public void testUntitled() throws Exception {
	//因为是绝对路径的url，所以删除baseUrl+的部分
    driver.get("file:///E:/Selenium/example/message.html");
    driver.findElement(By.name("name")).clear();
    driver.findElement(By.name("name")).sendKeys("jack");
    driver.findElement(By.name("e-mail")).clear();
    driver.findElement(By.name("e-mail")).sendKeys("jack@163.com");
    driver.findElement(By.name("comments")).clear();
    driver.findElement(By.name("comments")).sendKeys("Hello,jack!");
    driver.findElement(By.cssSelector("input[type=\"submit\"]")).click();
    assertEquals("留言簿", driver.getTitle());
    assertEquals("完 成", driver.findElement(By.cssSelector("input[type=\"submit\"]")).getAttribute("value"));
  }

  @After
  public void tearDown() throws Exception {
    driver.quit();
    String verificationErrorString = verificationErrors.toString();
    if (!"".equals(verificationErrorString)) {
      fail(verificationErrorString);
    }
  }

  private boolean isElementPresent(By by) {
    try {
      driver.findElement(by);
      return true;
    } catch (NoSuchElementException e) {
      return false;
    }
  }

  private boolean isAlertPresent() {
    try {
      driver.switchTo().alert();
      return true;
    } catch (NoAlertPresentException e) {
      return false;
    }
  }

  private String closeAlertAndGetItsText() {
    try {
      Alert alert = driver.switchTo().alert();
      String alertText = alert.getText();
      if (acceptNextAlert) {
        alert.accept();
      } else {
        alert.dismiss();
      }
      return alertText;
    } finally {
      acceptNextAlert = true;
    }
  }
}
</pre></div></div>
      <p class="number">步骤二：准备Chrome浏览器运行环境</p>
      <p>安装Chrome浏览器（”Selenium工具包“中有该安装文件29.0.1547.76_chrome_installer.exe）。</p>
      <p>在Selenium官网下载Chrome浏览器的驱动文件chromedriver.exe，放在指定的磁盘目录下（如C盘根目录），如下图-2所示：</p>
      <div class="image">
        <img src="./TEST SELENIUM DAY04_w_files/image002.png">
        <p>图 - 2</p>
      </div>
      <p class="number">步骤三：修改调整代码</p>
      <p>在ChromeMessage的Class，找到注解为@Before的setUp方法，修改启动浏览器的部分，修改为启动Chrome浏览器的代码。</p>
      <p>注意：启动Chrome浏览器需要单独指定chromedriver.exe的路径，需要设置的系统属性为webdriver.chrome.driver。</p>
      <p>代码如下所示：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/TESTING/TSDTN201801/SELENIUM/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/TESTING/TSDTN201801/SELENIUM/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/TESTING/TSDTN201801/SELENIUM/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li>package day04<span class="sh_symbol">;</span></li><li><span style="display:none;">&nbsp;</span></li><li>import java<span class="sh_symbol">.</span>util<span class="sh_symbol">.</span>regex<span class="sh_symbol">.</span>Pattern<span class="sh_symbol">;</span></li><li>import java<span class="sh_symbol">.</span>util<span class="sh_symbol">.</span>concurrent<span class="sh_symbol">.</span>TimeUnit<span class="sh_symbol">;</span></li><li>import org<span class="sh_symbol">.</span>junit<span class="sh_symbol">.*;</span></li><li>import <span class="sh_keyword">static</span> org<span class="sh_symbol">.</span>junit<span class="sh_symbol">.</span>Assert<span class="sh_symbol">.*;</span></li><li>import <span class="sh_keyword">static</span> org<span class="sh_symbol">.</span>hamcrest<span class="sh_symbol">.</span>CoreMatchers<span class="sh_symbol">.*;</span></li><li>import org<span class="sh_symbol">.</span>openqa<span class="sh_symbol">.</span>selenium<span class="sh_symbol">.*;</span></li><li class="bold_code">import org<span class="sh_symbol">.</span>openqa<span class="sh_symbol">.</span>selenium<span class="sh_symbol">.</span>chrome<span class="sh_symbol">.</span>ChromeDriver<span class="sh_symbol">;</span></li><li>import org<span class="sh_symbol">.</span>openqa<span class="sh_symbol">.</span>selenium<span class="sh_symbol">.</span>firefox<span class="sh_symbol">.</span>FirefoxDriver<span class="sh_symbol">;</span></li><li>import org<span class="sh_symbol">.</span>openqa<span class="sh_symbol">.</span>selenium<span class="sh_symbol">.</span>support<span class="sh_symbol">.</span>ui<span class="sh_symbol">.</span>Select<span class="sh_symbol">;</span></li><li><span style="display:none;">&nbsp;</span></li><li><span class="sh_keyword">public</span> <span class="sh_keyword">class</span> ChromeMessage <span class="sh_cbracket">{</span></li><li>  <span class="sh_keyword">private</span> WebDriver driver<span class="sh_symbol">;</span></li><li>  <span class="sh_keyword">private</span> <span class="sh_predef_func">String</span> baseUrl<span class="sh_symbol">;</span></li><li>  <span class="sh_keyword">private</span> boolean acceptNextAlert <span class="sh_symbol">=</span> <span class="sh_keyword">true</span><span class="sh_symbol">;</span></li><li>  <span class="sh_keyword">private</span> StringBuffer verificationErrors <span class="sh_symbol">=</span> <span class="sh_keyword">new</span> <span class="sh_function">StringBuffer</span><span class="sh_symbol">();</span></li><li><span style="display:none;">&nbsp;</span></li><li>  @Before</li><li>  <span class="sh_keyword">public</span> void <span class="sh_function">setUp</span><span class="sh_symbol">()</span> <span class="sh_keyword">throws</span> Exception <span class="sh_cbracket">{</span></li><li class="bold_code">&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//启动Chrome浏览器</span></li><li class="bold_code">&nbsp;&nbsp;&nbsp;&nbsp;System<span class="sh_symbol">.</span><span class="sh_function">setProperty</span><span class="sh_symbol">(</span><span class="sh_string">"webdriver.chrome.driver"</span><span class="sh_symbol">,</span> <span class="sh_string">"C:</span><span class="sh_specialchar">\\</span><span class="sh_string">chromedriver.exe"</span><span class="sh_symbol">);</span></li><li class="bold_code">    driver <span class="sh_symbol">=</span> <span class="sh_keyword">new</span> <span class="sh_function">ChromeDriver</span><span class="sh_symbol">();</span></li><li>    baseUrl <span class="sh_symbol">=</span> <span class="sh_string">"http://localhost/"</span><span class="sh_symbol">;</span></li><li>    driver<span class="sh_symbol">.</span><span class="sh_function">manage</span><span class="sh_symbol">().</span><span class="sh_function">timeouts</span><span class="sh_symbol">().</span><span class="sh_function">implicitlyWait</span><span class="sh_symbol">(</span><span class="sh_number">30</span><span class="sh_symbol">,</span> TimeUnit<span class="sh_symbol">.</span>SECONDS<span class="sh_symbol">);</span></li><li>  <span class="sh_cbracket">}</span></li><li><span style="display:none;">&nbsp;</span></li><li>  @Test</li><li>  <span class="sh_keyword">public</span> void <span class="sh_function">testUntitled</span><span class="sh_symbol">()</span> <span class="sh_keyword">throws</span> Exception <span class="sh_cbracket">{</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//因为是绝对路径的url，所以删除baseUrl+的部分</span></li><li>    driver<span class="sh_symbol">.</span><span class="sh_function">get</span><span class="sh_symbol">(</span><span class="sh_string">"file:///E:/Selenium/example/message.html"</span><span class="sh_symbol">);</span></li><li>    driver<span class="sh_symbol">.</span><span class="sh_function">findElement</span><span class="sh_symbol">(</span>By<span class="sh_symbol">.</span><span class="sh_function">name</span><span class="sh_symbol">(</span><span class="sh_string">"name"</span><span class="sh_symbol">)).</span><span class="sh_function">clear</span><span class="sh_symbol">();</span></li><li>    driver<span class="sh_symbol">.</span><span class="sh_function">findElement</span><span class="sh_symbol">(</span>By<span class="sh_symbol">.</span><span class="sh_function">name</span><span class="sh_symbol">(</span><span class="sh_string">"name"</span><span class="sh_symbol">)).</span><span class="sh_function">sendKeys</span><span class="sh_symbol">(</span><span class="sh_string">"jack"</span><span class="sh_symbol">);</span></li><li>    driver<span class="sh_symbol">.</span><span class="sh_function">findElement</span><span class="sh_symbol">(</span>By<span class="sh_symbol">.</span><span class="sh_function">name</span><span class="sh_symbol">(</span><span class="sh_string">"e-mail"</span><span class="sh_symbol">)).</span><span class="sh_function">clear</span><span class="sh_symbol">();</span></li><li>    driver<span class="sh_symbol">.</span><span class="sh_function">findElement</span><span class="sh_symbol">(</span>By<span class="sh_symbol">.</span><span class="sh_function">name</span><span class="sh_symbol">(</span><span class="sh_string">"e-mail"</span><span class="sh_symbol">)).</span><span class="sh_function">sendKeys</span><span class="sh_symbol">(</span><span class="sh_string">"jack@163.com"</span><span class="sh_symbol">);</span></li><li>    driver<span class="sh_symbol">.</span><span class="sh_function">findElement</span><span class="sh_symbol">(</span>By<span class="sh_symbol">.</span><span class="sh_function">name</span><span class="sh_symbol">(</span><span class="sh_string">"comments"</span><span class="sh_symbol">)).</span><span class="sh_function">clear</span><span class="sh_symbol">();</span></li><li>    driver<span class="sh_symbol">.</span><span class="sh_function">findElement</span><span class="sh_symbol">(</span>By<span class="sh_symbol">.</span><span class="sh_function">name</span><span class="sh_symbol">(</span><span class="sh_string">"comments"</span><span class="sh_symbol">)).</span><span class="sh_function">sendKeys</span><span class="sh_symbol">(</span><span class="sh_string">"Hello,jack!"</span><span class="sh_symbol">);</span></li><li>    driver<span class="sh_symbol">.</span><span class="sh_function">findElement</span><span class="sh_symbol">(</span>By<span class="sh_symbol">.</span><span class="sh_function">cssSelector</span><span class="sh_symbol">(</span><span class="sh_string">"input[type=</span><span class="sh_specialchar">\"</span><span class="sh_string">submit</span><span class="sh_specialchar">\"</span><span class="sh_string">]"</span><span class="sh_symbol">)).</span><span class="sh_function">click</span><span class="sh_symbol">();</span></li><li>    <span class="sh_function">assertEquals</span><span class="sh_symbol">(</span><span class="sh_string">"留言簿"</span><span class="sh_symbol">,</span> driver<span class="sh_symbol">.</span><span class="sh_function">getTitle</span><span class="sh_symbol">());</span></li><li>    <span class="sh_function">assertEquals</span><span class="sh_symbol">(</span><span class="sh_string">"完 成"</span><span class="sh_symbol">,</span> driver<span class="sh_symbol">.</span><span class="sh_function">findElement</span><span class="sh_symbol">(</span>By<span class="sh_symbol">.</span><span class="sh_function">cssSelector</span><span class="sh_symbol">(</span><span class="sh_string">"input[type=</span><span class="sh_specialchar">\"</span><span class="sh_string">submit</span><span class="sh_specialchar">\"</span><span class="sh_string">]"</span><span class="sh_symbol">)).</span><span class="sh_function">getAttribute</span><span class="sh_symbol">(</span><span class="sh_string">"value"</span><span class="sh_symbol">));</span></li><li>  <span class="sh_cbracket">}</span></li><li><span style="display:none;">&nbsp;</span></li><li>  @After</li><li>  <span class="sh_keyword">public</span> void <span class="sh_function">tearDown</span><span class="sh_symbol">()</span> <span class="sh_keyword">throws</span> Exception <span class="sh_cbracket">{</span></li><li>    driver<span class="sh_symbol">.</span><span class="sh_function">quit</span><span class="sh_symbol">();</span></li><li>    <span class="sh_predef_func">String</span> verificationErrorString <span class="sh_symbol">=</span> verificationErrors<span class="sh_symbol">.</span><span class="sh_function">toString</span><span class="sh_symbol">();</span></li><li>    <span class="sh_keyword">if</span> <span class="sh_symbol">(!</span><span class="sh_string">""</span><span class="sh_symbol">.</span><span class="sh_function">equals</span><span class="sh_symbol">(</span>verificationErrorString<span class="sh_symbol">))</span> <span class="sh_cbracket">{</span></li><li>      <span class="sh_function">fail</span><span class="sh_symbol">(</span>verificationErrorString<span class="sh_symbol">);</span></li><li>    <span class="sh_cbracket">}</span></li><li>  <span class="sh_cbracket">}</span></li><li><span style="display:none;">&nbsp;</span></li><li>  <span class="sh_keyword">private</span> boolean <span class="sh_function">isElementPresent</span><span class="sh_symbol">(</span>By by<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span></li><li>    <span class="sh_keyword">try</span> <span class="sh_cbracket">{</span></li><li>      driver<span class="sh_symbol">.</span><span class="sh_function">findElement</span><span class="sh_symbol">(</span>by<span class="sh_symbol">);</span></li><li>      <span class="sh_keyword">return</span> <span class="sh_keyword">true</span><span class="sh_symbol">;</span></li><li>    <span class="sh_cbracket">}</span> <span class="sh_keyword">catch</span> <span class="sh_symbol">(</span>NoSuchElementException e<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span></li><li>      <span class="sh_keyword">return</span> <span class="sh_keyword">false</span><span class="sh_symbol">;</span></li><li>    <span class="sh_cbracket">}</span></li><li>  <span class="sh_cbracket">}</span></li><li><span style="display:none;">&nbsp;</span></li><li>  <span class="sh_keyword">private</span> boolean <span class="sh_function">isAlertPresent</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span></li><li>    <span class="sh_keyword">try</span> <span class="sh_cbracket">{</span></li><li>      driver<span class="sh_symbol">.</span><span class="sh_function">switchTo</span><span class="sh_symbol">().</span><span class="sh_function">alert</span><span class="sh_symbol">();</span></li><li>      <span class="sh_keyword">return</span> <span class="sh_keyword">true</span><span class="sh_symbol">;</span></li><li>    <span class="sh_cbracket">}</span> <span class="sh_keyword">catch</span> <span class="sh_symbol">(</span>NoAlertPresentException e<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span></li><li>      <span class="sh_keyword">return</span> <span class="sh_keyword">false</span><span class="sh_symbol">;</span></li><li>    <span class="sh_cbracket">}</span></li><li>  <span class="sh_cbracket">}</span></li><li><span style="display:none;">&nbsp;</span></li><li>  <span class="sh_keyword">private</span> <span class="sh_predef_func">String</span> <span class="sh_function">closeAlertAndGetItsText</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span></li><li>    <span class="sh_keyword">try</span> <span class="sh_cbracket">{</span></li><li>      Alert alert <span class="sh_symbol">=</span> driver<span class="sh_symbol">.</span><span class="sh_function">switchTo</span><span class="sh_symbol">().</span><span class="sh_function">alert</span><span class="sh_symbol">();</span></li><li>      <span class="sh_predef_func">String</span> alertText <span class="sh_symbol">=</span> alert<span class="sh_symbol">.</span><span class="sh_function">getText</span><span class="sh_symbol">();</span></li><li>      <span class="sh_keyword">if</span> <span class="sh_symbol">(</span>acceptNextAlert<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span></li><li>        alert<span class="sh_symbol">.</span><span class="sh_function">accept</span><span class="sh_symbol">();</span></li><li>      <span class="sh_cbracket">}</span> <span class="sh_keyword">else</span> <span class="sh_cbracket">{</span></li><li>        alert<span class="sh_symbol">.</span><span class="sh_function">dismiss</span><span class="sh_symbol">();</span></li><li>      <span class="sh_cbracket">}</span></li><li>      <span class="sh_keyword">return</span> alertText<span class="sh_symbol">;</span></li><li>    <span class="sh_cbracket">}</span> <span class="sh_keyword">finally</span> <span class="sh_cbracket">{</span></li><li>      acceptNextAlert <span class="sh_symbol">=</span> <span class="sh_keyword">true</span><span class="sh_symbol">;</span></li><li>    <span class="sh_cbracket">}</span></li><li>  <span class="sh_cbracket">}</span></li><li><span class="sh_cbracket">}</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">package day04;

import java.util.regex.Pattern;
import java.util.concurrent.TimeUnit;
import org.junit.*;
import static org.junit.Assert.*;
import static org.hamcrest.CoreMatchers.*;
import org.openqa.selenium.*;
#cold_boldimport org.openqa.selenium.chrome.ChromeDriver;
import org.openqa.selenium.firefox.FirefoxDriver;
import org.openqa.selenium.support.ui.Select;

public class ChromeMessage {
  private WebDriver driver;
  private String baseUrl;
  private boolean acceptNextAlert = true;
  private StringBuffer verificationErrors = new StringBuffer();

  @Before
  public void setUp() throws Exception {
#cold_bold	//启动Chrome浏览器
#cold_bold	System.setProperty("webdriver.chrome.driver", "C:\\chromedriver.exe");
#cold_bold    driver = new ChromeDriver();
    baseUrl = "http://localhost/";
    driver.manage().timeouts().implicitlyWait(30, TimeUnit.SECONDS);
  }

  @Test
  public void testUntitled() throws Exception {
	//因为是绝对路径的url，所以删除baseUrl+的部分
    driver.get("file:///E:/Selenium/example/message.html");
    driver.findElement(By.name("name")).clear();
    driver.findElement(By.name("name")).sendKeys("jack");
    driver.findElement(By.name("e-mail")).clear();
    driver.findElement(By.name("e-mail")).sendKeys("jack@163.com");
    driver.findElement(By.name("comments")).clear();
    driver.findElement(By.name("comments")).sendKeys("Hello,jack!");
    driver.findElement(By.cssSelector("input[type=\"submit\"]")).click();
    assertEquals("留言簿", driver.getTitle());
    assertEquals("完 成", driver.findElement(By.cssSelector("input[type=\"submit\"]")).getAttribute("value"));
  }

  @After
  public void tearDown() throws Exception {
    driver.quit();
    String verificationErrorString = verificationErrors.toString();
    if (!"".equals(verificationErrorString)) {
      fail(verificationErrorString);
    }
  }

  private boolean isElementPresent(By by) {
    try {
      driver.findElement(by);
      return true;
    } catch (NoSuchElementException e) {
      return false;
    }
  }

  private boolean isAlertPresent() {
    try {
      driver.switchTo().alert();
      return true;
    } catch (NoAlertPresentException e) {
      return false;
    }
  }

  private String closeAlertAndGetItsText() {
    try {
      Alert alert = driver.switchTo().alert();
      String alertText = alert.getText();
      if (acceptNextAlert) {
        alert.accept();
      } else {
        alert.dismiss();
      }
      return alertText;
    } finally {
      acceptNextAlert = true;
    }
  }
}
</pre></div></div>
      <p class="number">步骤四：运行调试代码</p>
      <p>在该类上点击右键，选择Run As\JUnit Test来运行JUnit测试用例代码，查看被测系统被启动，并且执行相应的自动化测试步骤。</p>
      <p>查看JUnit视图中的运行状态条，如果为绿色，代表运行成功，如果为红色，需要查看Failure Trace确认和定位问题。</p>
      <h3>1.4 完整代码</h3>
      <p>本案例中，ChromeMessage类的完整代码如下所示：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap" style="display: none;"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/TESTING/TSDTN201801/SELENIUM/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/TESTING/TSDTN201801/SELENIUM/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/TESTING/TSDTN201801/SELENIUM/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="hide sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li>package day04<span class="sh_symbol">;</span></li><li><span style="display:none;">&nbsp;</span></li><li>import java<span class="sh_symbol">.</span>util<span class="sh_symbol">.</span>regex<span class="sh_symbol">.</span>Pattern<span class="sh_symbol">;</span></li><li>import java<span class="sh_symbol">.</span>util<span class="sh_symbol">.</span>concurrent<span class="sh_symbol">.</span>TimeUnit<span class="sh_symbol">;</span></li><li>import org<span class="sh_symbol">.</span>junit<span class="sh_symbol">.*;</span></li><li>import <span class="sh_keyword">static</span> org<span class="sh_symbol">.</span>junit<span class="sh_symbol">.</span>Assert<span class="sh_symbol">.*;</span></li><li>import <span class="sh_keyword">static</span> org<span class="sh_symbol">.</span>hamcrest<span class="sh_symbol">.</span>CoreMatchers<span class="sh_symbol">.*;</span></li><li>import org<span class="sh_symbol">.</span>openqa<span class="sh_symbol">.</span>selenium<span class="sh_symbol">.*;</span></li><li>import org<span class="sh_symbol">.</span>openqa<span class="sh_symbol">.</span>selenium<span class="sh_symbol">.</span>chrome<span class="sh_symbol">.</span>ChromeDriver<span class="sh_symbol">;</span></li><li>import org<span class="sh_symbol">.</span>openqa<span class="sh_symbol">.</span>selenium<span class="sh_symbol">.</span>firefox<span class="sh_symbol">.</span>FirefoxDriver<span class="sh_symbol">;</span></li><li>import org<span class="sh_symbol">.</span>openqa<span class="sh_symbol">.</span>selenium<span class="sh_symbol">.</span>support<span class="sh_symbol">.</span>ui<span class="sh_symbol">.</span>Select<span class="sh_symbol">;</span></li><li><span style="display:none;">&nbsp;</span></li><li><span class="sh_keyword">public</span> <span class="sh_keyword">class</span> ChromeMessage <span class="sh_cbracket">{</span></li><li>  <span class="sh_keyword">private</span> WebDriver driver<span class="sh_symbol">;</span></li><li>  <span class="sh_keyword">private</span> <span class="sh_predef_func">String</span> baseUrl<span class="sh_symbol">;</span></li><li>  <span class="sh_keyword">private</span> boolean acceptNextAlert <span class="sh_symbol">=</span> <span class="sh_keyword">true</span><span class="sh_symbol">;</span></li><li>  <span class="sh_keyword">private</span> StringBuffer verificationErrors <span class="sh_symbol">=</span> <span class="sh_keyword">new</span> <span class="sh_function">StringBuffer</span><span class="sh_symbol">();</span></li><li><span style="display:none;">&nbsp;</span></li><li>  @Before</li><li>  <span class="sh_keyword">public</span> void <span class="sh_function">setUp</span><span class="sh_symbol">()</span> <span class="sh_keyword">throws</span> Exception <span class="sh_cbracket">{</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//启动Chrome浏览器</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;System<span class="sh_symbol">.</span><span class="sh_function">setProperty</span><span class="sh_symbol">(</span><span class="sh_string">"webdriver.chrome.driver"</span><span class="sh_symbol">,</span> <span class="sh_string">"C:</span><span class="sh_specialchar">\\</span><span class="sh_string">chromedriver.exe"</span><span class="sh_symbol">);</span></li><li>    driver <span class="sh_symbol">=</span> <span class="sh_keyword">new</span> <span class="sh_function">ChromeDriver</span><span class="sh_symbol">();</span></li><li>    baseUrl <span class="sh_symbol">=</span> <span class="sh_string">"http://localhost/"</span><span class="sh_symbol">;</span></li><li>    driver<span class="sh_symbol">.</span><span class="sh_function">manage</span><span class="sh_symbol">().</span><span class="sh_function">timeouts</span><span class="sh_symbol">().</span><span class="sh_function">implicitlyWait</span><span class="sh_symbol">(</span><span class="sh_number">30</span><span class="sh_symbol">,</span> TimeUnit<span class="sh_symbol">.</span>SECONDS<span class="sh_symbol">);</span></li><li>  <span class="sh_cbracket">}</span></li><li><span style="display:none;">&nbsp;</span></li><li>  @Test</li><li>  <span class="sh_keyword">public</span> void <span class="sh_function">testUntitled</span><span class="sh_symbol">()</span> <span class="sh_keyword">throws</span> Exception <span class="sh_cbracket">{</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//因为是绝对路径的url，所以删除baseUrl+的部分</span></li><li>    driver<span class="sh_symbol">.</span><span class="sh_function">get</span><span class="sh_symbol">(</span><span class="sh_string">"file:///E:/Selenium/example/message.html"</span><span class="sh_symbol">);</span></li><li>    driver<span class="sh_symbol">.</span><span class="sh_function">findElement</span><span class="sh_symbol">(</span>By<span class="sh_symbol">.</span><span class="sh_function">name</span><span class="sh_symbol">(</span><span class="sh_string">"name"</span><span class="sh_symbol">)).</span><span class="sh_function">clear</span><span class="sh_symbol">();</span></li><li>    driver<span class="sh_symbol">.</span><span class="sh_function">findElement</span><span class="sh_symbol">(</span>By<span class="sh_symbol">.</span><span class="sh_function">name</span><span class="sh_symbol">(</span><span class="sh_string">"name"</span><span class="sh_symbol">)).</span><span class="sh_function">sendKeys</span><span class="sh_symbol">(</span><span class="sh_string">"jack"</span><span class="sh_symbol">);</span></li><li>    driver<span class="sh_symbol">.</span><span class="sh_function">findElement</span><span class="sh_symbol">(</span>By<span class="sh_symbol">.</span><span class="sh_function">name</span><span class="sh_symbol">(</span><span class="sh_string">"e-mail"</span><span class="sh_symbol">)).</span><span class="sh_function">clear</span><span class="sh_symbol">();</span></li><li>    driver<span class="sh_symbol">.</span><span class="sh_function">findElement</span><span class="sh_symbol">(</span>By<span class="sh_symbol">.</span><span class="sh_function">name</span><span class="sh_symbol">(</span><span class="sh_string">"e-mail"</span><span class="sh_symbol">)).</span><span class="sh_function">sendKeys</span><span class="sh_symbol">(</span><span class="sh_string">"jack@163.com"</span><span class="sh_symbol">);</span></li><li>    driver<span class="sh_symbol">.</span><span class="sh_function">findElement</span><span class="sh_symbol">(</span>By<span class="sh_symbol">.</span><span class="sh_function">name</span><span class="sh_symbol">(</span><span class="sh_string">"comments"</span><span class="sh_symbol">)).</span><span class="sh_function">clear</span><span class="sh_symbol">();</span></li><li>    driver<span class="sh_symbol">.</span><span class="sh_function">findElement</span><span class="sh_symbol">(</span>By<span class="sh_symbol">.</span><span class="sh_function">name</span><span class="sh_symbol">(</span><span class="sh_string">"comments"</span><span class="sh_symbol">)).</span><span class="sh_function">sendKeys</span><span class="sh_symbol">(</span><span class="sh_string">"Hello,jack!"</span><span class="sh_symbol">);</span></li><li>    driver<span class="sh_symbol">.</span><span class="sh_function">findElement</span><span class="sh_symbol">(</span>By<span class="sh_symbol">.</span><span class="sh_function">cssSelector</span><span class="sh_symbol">(</span><span class="sh_string">"input[type=</span><span class="sh_specialchar">\"</span><span class="sh_string">submit</span><span class="sh_specialchar">\"</span><span class="sh_string">]"</span><span class="sh_symbol">)).</span><span class="sh_function">click</span><span class="sh_symbol">();</span></li><li>    <span class="sh_function">assertEquals</span><span class="sh_symbol">(</span><span class="sh_string">"留言簿"</span><span class="sh_symbol">,</span> driver<span class="sh_symbol">.</span><span class="sh_function">getTitle</span><span class="sh_symbol">());</span></li><li>    <span class="sh_function">assertEquals</span><span class="sh_symbol">(</span><span class="sh_string">"完 成"</span><span class="sh_symbol">,</span> driver<span class="sh_symbol">.</span><span class="sh_function">findElement</span><span class="sh_symbol">(</span>By<span class="sh_symbol">.</span><span class="sh_function">cssSelector</span><span class="sh_symbol">(</span><span class="sh_string">"input[type=</span><span class="sh_specialchar">\"</span><span class="sh_string">submit</span><span class="sh_specialchar">\"</span><span class="sh_string">]"</span><span class="sh_symbol">)).</span><span class="sh_function">getAttribute</span><span class="sh_symbol">(</span><span class="sh_string">"value"</span><span class="sh_symbol">));</span></li><li>  <span class="sh_cbracket">}</span></li><li><span style="display:none;">&nbsp;</span></li><li>  @After</li><li>  <span class="sh_keyword">public</span> void <span class="sh_function">tearDown</span><span class="sh_symbol">()</span> <span class="sh_keyword">throws</span> Exception <span class="sh_cbracket">{</span></li><li>    driver<span class="sh_symbol">.</span><span class="sh_function">quit</span><span class="sh_symbol">();</span></li><li>    <span class="sh_predef_func">String</span> verificationErrorString <span class="sh_symbol">=</span> verificationErrors<span class="sh_symbol">.</span><span class="sh_function">toString</span><span class="sh_symbol">();</span></li><li>    <span class="sh_keyword">if</span> <span class="sh_symbol">(!</span><span class="sh_string">""</span><span class="sh_symbol">.</span><span class="sh_function">equals</span><span class="sh_symbol">(</span>verificationErrorString<span class="sh_symbol">))</span> <span class="sh_cbracket">{</span></li><li>      <span class="sh_function">fail</span><span class="sh_symbol">(</span>verificationErrorString<span class="sh_symbol">);</span></li><li>    <span class="sh_cbracket">}</span></li><li>  <span class="sh_cbracket">}</span></li><li><span style="display:none;">&nbsp;</span></li><li>  <span class="sh_keyword">private</span> boolean <span class="sh_function">isElementPresent</span><span class="sh_symbol">(</span>By by<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span></li><li>    <span class="sh_keyword">try</span> <span class="sh_cbracket">{</span></li><li>      driver<span class="sh_symbol">.</span><span class="sh_function">findElement</span><span class="sh_symbol">(</span>by<span class="sh_symbol">);</span></li><li>      <span class="sh_keyword">return</span> <span class="sh_keyword">true</span><span class="sh_symbol">;</span></li><li>    <span class="sh_cbracket">}</span> <span class="sh_keyword">catch</span> <span class="sh_symbol">(</span>NoSuchElementException e<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span></li><li>      <span class="sh_keyword">return</span> <span class="sh_keyword">false</span><span class="sh_symbol">;</span></li><li>    <span class="sh_cbracket">}</span></li><li>  <span class="sh_cbracket">}</span></li><li><span style="display:none;">&nbsp;</span></li><li>  <span class="sh_keyword">private</span> boolean <span class="sh_function">isAlertPresent</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span></li><li>    <span class="sh_keyword">try</span> <span class="sh_cbracket">{</span></li><li>      driver<span class="sh_symbol">.</span><span class="sh_function">switchTo</span><span class="sh_symbol">().</span><span class="sh_function">alert</span><span class="sh_symbol">();</span></li><li>      <span class="sh_keyword">return</span> <span class="sh_keyword">true</span><span class="sh_symbol">;</span></li><li>    <span class="sh_cbracket">}</span> <span class="sh_keyword">catch</span> <span class="sh_symbol">(</span>NoAlertPresentException e<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span></li><li>      <span class="sh_keyword">return</span> <span class="sh_keyword">false</span><span class="sh_symbol">;</span></li><li>    <span class="sh_cbracket">}</span></li><li>  <span class="sh_cbracket">}</span></li><li><span style="display:none;">&nbsp;</span></li><li>  <span class="sh_keyword">private</span> <span class="sh_predef_func">String</span> <span class="sh_function">closeAlertAndGetItsText</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span></li><li>    <span class="sh_keyword">try</span> <span class="sh_cbracket">{</span></li><li>      Alert alert <span class="sh_symbol">=</span> driver<span class="sh_symbol">.</span><span class="sh_function">switchTo</span><span class="sh_symbol">().</span><span class="sh_function">alert</span><span class="sh_symbol">();</span></li><li>      <span class="sh_predef_func">String</span> alertText <span class="sh_symbol">=</span> alert<span class="sh_symbol">.</span><span class="sh_function">getText</span><span class="sh_symbol">();</span></li><li>      <span class="sh_keyword">if</span> <span class="sh_symbol">(</span>acceptNextAlert<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span></li><li>        alert<span class="sh_symbol">.</span><span class="sh_function">accept</span><span class="sh_symbol">();</span></li><li>      <span class="sh_cbracket">}</span> <span class="sh_keyword">else</span> <span class="sh_cbracket">{</span></li><li>        alert<span class="sh_symbol">.</span><span class="sh_function">dismiss</span><span class="sh_symbol">();</span></li><li>      <span class="sh_cbracket">}</span></li><li>      <span class="sh_keyword">return</span> alertText<span class="sh_symbol">;</span></li><li>    <span class="sh_cbracket">}</span> <span class="sh_keyword">finally</span> <span class="sh_cbracket">{</span></li><li>      acceptNextAlert <span class="sh_symbol">=</span> <span class="sh_keyword">true</span><span class="sh_symbol">;</span></li><li>    <span class="sh_cbracket">}</span></li><li>  <span class="sh_cbracket">}</span></li><li><span class="sh_cbracket">}</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">package day04;

import java.util.regex.Pattern;
import java.util.concurrent.TimeUnit;
import org.junit.*;
import static org.junit.Assert.*;
import static org.hamcrest.CoreMatchers.*;
import org.openqa.selenium.*;
import org.openqa.selenium.chrome.ChromeDriver;
import org.openqa.selenium.firefox.FirefoxDriver;
import org.openqa.selenium.support.ui.Select;

public class ChromeMessage {
  private WebDriver driver;
  private String baseUrl;
  private boolean acceptNextAlert = true;
  private StringBuffer verificationErrors = new StringBuffer();

  @Before
  public void setUp() throws Exception {
	//启动Chrome浏览器
	System.setProperty("webdriver.chrome.driver", "C:\\chromedriver.exe");
    driver = new ChromeDriver();
    baseUrl = "http://localhost/";
    driver.manage().timeouts().implicitlyWait(30, TimeUnit.SECONDS);
  }

  @Test
  public void testUntitled() throws Exception {
	//因为是绝对路径的url，所以删除baseUrl+的部分
    driver.get("file:///E:/Selenium/example/message.html");
    driver.findElement(By.name("name")).clear();
    driver.findElement(By.name("name")).sendKeys("jack");
    driver.findElement(By.name("e-mail")).clear();
    driver.findElement(By.name("e-mail")).sendKeys("jack@163.com");
    driver.findElement(By.name("comments")).clear();
    driver.findElement(By.name("comments")).sendKeys("Hello,jack!");
    driver.findElement(By.cssSelector("input[type=\"submit\"]")).click();
    assertEquals("留言簿", driver.getTitle());
    assertEquals("完 成", driver.findElement(By.cssSelector("input[type=\"submit\"]")).getAttribute("value"));
  }

  @After
  public void tearDown() throws Exception {
    driver.quit();
    String verificationErrorString = verificationErrors.toString();
    if (!"".equals(verificationErrorString)) {
      fail(verificationErrorString);
    }
  }

  private boolean isElementPresent(By by) {
    try {
      driver.findElement(by);
      return true;
    } catch (NoSuchElementException e) {
      return false;
    }
  }

  private boolean isAlertPresent() {
    try {
      driver.switchTo().alert();
      return true;
    } catch (NoAlertPresentException e) {
      return false;
    }
  }

  private String closeAlertAndGetItsText() {
    try {
      Alert alert = driver.switchTo().alert();
      String alertText = alert.getText();
      if (acceptNextAlert) {
        alert.accept();
      } else {
        alert.dismiss();
      }
      return alertText;
    } finally {
      acceptNextAlert = true;
    }
  }
}
</pre><div class="sh_sourceCode snippet-hide"><pre><a href="http://tts.tmooc.cn/ttsPage/TESTING/TSDTN201801/SELENIUM/DAY04/CASE/01/index.html#" class="snippet-revealed snippet-toggle sh_url">隐藏</a></pre></div></div><div class="snippet-reveal sh_acid snippet-wrap"><pre class="sh_sourceCode"><a href="http://tts.tmooc.cn/ttsPage/TESTING/TSDTN201801/SELENIUM/DAY04/CASE/01/index.html#" class="snippet-toggle sh_url">代码</a></pre></div></div>
      <a name="case2">
      </a>
      <h2>2 IE测试留言簿</h2>
      <h3>2.1 问题</h3>
      <p>使用IE浏览器测试留言簿(example目录下的message.html程序)，需要实现在留言簿的被测系统中，完成如下操作的步骤：</p>
      <p>（1）在“名字”文本框中输入数据“jack”；</p>
      <p>（2）在“e-mail”文本框中输入数据“jack@163.com”；</p>
      <p>（3）在“留言”文本框中输入数据“Hello,jack!”；</p>
      <p>（4）点击“完成”按钮；</p>
      <p>（5）断言当前网页的标题等于“留言簿”；</p>
      <p>（6）断言“完成”按钮上的文字正确。</p>
      <h3>2.2 方案</h3>
      <p>本案例针对留言簿程序的操作步骤和前面的案例（Firefox测试留言簿）要求相同，只是使用的浏览器换为IE而已，所以我们可以直接复制前面的案例的类（FirefoxMessage1.java）；</p>
      <p>Internet Explorer，是美国微软公司推出的一款网页浏览器。原称Microsoft Internet Explorer和Windows Internet Explorer，简称IE。</p>
      <p>首先，需要准备IE的驱动文件，确认IE浏览器已经安装好；</p>
      <p>其次，需要在新复制的类中修改启动浏览器的步骤为启动IE浏览器，指定相应的浏览器驱动文件，导入相应的类。</p>
      <p>再次，需要设置IE的Internet选项中，高级设置部分，勾选“允许活动内容在我的计算机的文件中运行”的复选框，重启IE浏览器后生效。</p>
      <p>最后，需要运行整个JUnit测试用例或来查看结果。</p>
      <h3>2.3 步骤</h3>
      <p>实现此案例需要按照如下步骤进行。</p>
      <p class="number">步骤一：复制上一案例的JUnit类代码</p>
      <p>在Project1的day03的package下，选中上一案例（Firefox测试留言簿）完成的JUnit类（FirefoxMessage1.java）,使用右键菜单Copy或者快捷键Ctrl+C来复制类文件，点击选中day04包后，使用右键菜单Paste或Ctrl+V来粘贴该文件，选中该文件后，使用F2快捷键，修改类名为IEMessage，点击”Finish“按钮，如下图-3所示：</p>
      <div class="image">
        <img src="./TEST SELENIUM DAY04_w_files/image003.png">
        <p>图 - 3</p>
      </div>
      <p>IEMessage.java的代码如下所示：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/TESTING/TSDTN201801/SELENIUM/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/TESTING/TSDTN201801/SELENIUM/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/TESTING/TSDTN201801/SELENIUM/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li>package day04<span class="sh_symbol">;</span></li><li><span style="display:none;">&nbsp;</span></li><li>import java<span class="sh_symbol">.</span>util<span class="sh_symbol">.</span>regex<span class="sh_symbol">.</span>Pattern<span class="sh_symbol">;</span></li><li>import java<span class="sh_symbol">.</span>util<span class="sh_symbol">.</span>concurrent<span class="sh_symbol">.</span>TimeUnit<span class="sh_symbol">;</span></li><li>import org<span class="sh_symbol">.</span>junit<span class="sh_symbol">.*;</span></li><li>import <span class="sh_keyword">static</span> org<span class="sh_symbol">.</span>junit<span class="sh_symbol">.</span>Assert<span class="sh_symbol">.*;</span></li><li>import <span class="sh_keyword">static</span> org<span class="sh_symbol">.</span>hamcrest<span class="sh_symbol">.</span>CoreMatchers<span class="sh_symbol">.*;</span></li><li>import org<span class="sh_symbol">.</span>openqa<span class="sh_symbol">.</span>selenium<span class="sh_symbol">.*;</span></li><li>import org<span class="sh_symbol">.</span>openqa<span class="sh_symbol">.</span>selenium<span class="sh_symbol">.</span>firefox<span class="sh_symbol">.</span>FirefoxDriver<span class="sh_symbol">;</span></li><li>import org<span class="sh_symbol">.</span>openqa<span class="sh_symbol">.</span>selenium<span class="sh_symbol">.</span>support<span class="sh_symbol">.</span>ui<span class="sh_symbol">.</span>Select<span class="sh_symbol">;</span></li><li><span style="display:none;">&nbsp;</span></li><li><span class="sh_keyword">public</span> <span class="sh_keyword">class</span> IEMessage <span class="sh_cbracket">{</span></li><li>  <span class="sh_keyword">private</span> WebDriver driver<span class="sh_symbol">;</span></li><li>  <span class="sh_keyword">private</span> <span class="sh_predef_func">String</span> baseUrl<span class="sh_symbol">;</span></li><li>  <span class="sh_keyword">private</span> boolean acceptNextAlert <span class="sh_symbol">=</span> <span class="sh_keyword">true</span><span class="sh_symbol">;</span></li><li>  <span class="sh_keyword">private</span> StringBuffer verificationErrors <span class="sh_symbol">=</span> <span class="sh_keyword">new</span> <span class="sh_function">StringBuffer</span><span class="sh_symbol">();</span></li><li><span style="display:none;">&nbsp;</span></li><li>  @Before</li><li>  <span class="sh_keyword">public</span> void <span class="sh_function">setUp</span><span class="sh_symbol">()</span> <span class="sh_keyword">throws</span> Exception <span class="sh_cbracket">{</span></li><li>    driver <span class="sh_symbol">=</span> <span class="sh_keyword">new</span> <span class="sh_function">FirefoxDriver</span><span class="sh_symbol">();</span></li><li>    baseUrl <span class="sh_symbol">=</span> <span class="sh_string">"http://localhost/"</span><span class="sh_symbol">;</span></li><li>    driver<span class="sh_symbol">.</span><span class="sh_function">manage</span><span class="sh_symbol">().</span><span class="sh_function">timeouts</span><span class="sh_symbol">().</span><span class="sh_function">implicitlyWait</span><span class="sh_symbol">(</span><span class="sh_number">30</span><span class="sh_symbol">,</span> TimeUnit<span class="sh_symbol">.</span>SECONDS<span class="sh_symbol">);</span></li><li>  <span class="sh_cbracket">}</span></li><li><span style="display:none;">&nbsp;</span></li><li>  @Test</li><li>  <span class="sh_keyword">public</span> void <span class="sh_function">testUntitled</span><span class="sh_symbol">()</span> <span class="sh_keyword">throws</span> Exception <span class="sh_cbracket">{</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//因为是绝对路径的url，所以删除baseUrl+的部分</span></li><li>    driver<span class="sh_symbol">.</span><span class="sh_function">get</span><span class="sh_symbol">(</span><span class="sh_string">"file:///E:/Selenium/example/message.html"</span><span class="sh_symbol">);</span></li><li>    driver<span class="sh_symbol">.</span><span class="sh_function">findElement</span><span class="sh_symbol">(</span>By<span class="sh_symbol">.</span><span class="sh_function">name</span><span class="sh_symbol">(</span><span class="sh_string">"name"</span><span class="sh_symbol">)).</span><span class="sh_function">clear</span><span class="sh_symbol">();</span></li><li>    driver<span class="sh_symbol">.</span><span class="sh_function">findElement</span><span class="sh_symbol">(</span>By<span class="sh_symbol">.</span><span class="sh_function">name</span><span class="sh_symbol">(</span><span class="sh_string">"name"</span><span class="sh_symbol">)).</span><span class="sh_function">sendKeys</span><span class="sh_symbol">(</span><span class="sh_string">"jack"</span><span class="sh_symbol">);</span></li><li>    driver<span class="sh_symbol">.</span><span class="sh_function">findElement</span><span class="sh_symbol">(</span>By<span class="sh_symbol">.</span><span class="sh_function">name</span><span class="sh_symbol">(</span><span class="sh_string">"e-mail"</span><span class="sh_symbol">)).</span><span class="sh_function">clear</span><span class="sh_symbol">();</span></li><li>    driver<span class="sh_symbol">.</span><span class="sh_function">findElement</span><span class="sh_symbol">(</span>By<span class="sh_symbol">.</span><span class="sh_function">name</span><span class="sh_symbol">(</span><span class="sh_string">"e-mail"</span><span class="sh_symbol">)).</span><span class="sh_function">sendKeys</span><span class="sh_symbol">(</span><span class="sh_string">"jack@163.com"</span><span class="sh_symbol">);</span></li><li>    driver<span class="sh_symbol">.</span><span class="sh_function">findElement</span><span class="sh_symbol">(</span>By<span class="sh_symbol">.</span><span class="sh_function">name</span><span class="sh_symbol">(</span><span class="sh_string">"comments"</span><span class="sh_symbol">)).</span><span class="sh_function">clear</span><span class="sh_symbol">();</span></li><li>    driver<span class="sh_symbol">.</span><span class="sh_function">findElement</span><span class="sh_symbol">(</span>By<span class="sh_symbol">.</span><span class="sh_function">name</span><span class="sh_symbol">(</span><span class="sh_string">"comments"</span><span class="sh_symbol">)).</span><span class="sh_function">sendKeys</span><span class="sh_symbol">(</span><span class="sh_string">"Hello,jack!"</span><span class="sh_symbol">);</span></li><li>    driver<span class="sh_symbol">.</span><span class="sh_function">findElement</span><span class="sh_symbol">(</span>By<span class="sh_symbol">.</span><span class="sh_function">cssSelector</span><span class="sh_symbol">(</span><span class="sh_string">"input[type=</span><span class="sh_specialchar">\"</span><span class="sh_string">submit</span><span class="sh_specialchar">\"</span><span class="sh_string">]"</span><span class="sh_symbol">)).</span><span class="sh_function">click</span><span class="sh_symbol">();</span></li><li>    <span class="sh_function">assertEquals</span><span class="sh_symbol">(</span><span class="sh_string">"留言簿"</span><span class="sh_symbol">,</span> driver<span class="sh_symbol">.</span><span class="sh_function">getTitle</span><span class="sh_symbol">());</span></li><li>    <span class="sh_function">assertEquals</span><span class="sh_symbol">(</span><span class="sh_string">"完 成"</span><span class="sh_symbol">,</span> driver<span class="sh_symbol">.</span><span class="sh_function">findElement</span><span class="sh_symbol">(</span>By<span class="sh_symbol">.</span><span class="sh_function">cssSelector</span><span class="sh_symbol">(</span><span class="sh_string">"input[type=</span><span class="sh_specialchar">\"</span><span class="sh_string">submit</span><span class="sh_specialchar">\"</span><span class="sh_string">]"</span><span class="sh_symbol">)).</span><span class="sh_function">getAttribute</span><span class="sh_symbol">(</span><span class="sh_string">"value"</span><span class="sh_symbol">));</span></li><li>  <span class="sh_cbracket">}</span></li><li><span style="display:none;">&nbsp;</span></li><li>  @After</li><li>  <span class="sh_keyword">public</span> void <span class="sh_function">tearDown</span><span class="sh_symbol">()</span> <span class="sh_keyword">throws</span> Exception <span class="sh_cbracket">{</span></li><li>    driver<span class="sh_symbol">.</span><span class="sh_function">quit</span><span class="sh_symbol">();</span></li><li>    <span class="sh_predef_func">String</span> verificationErrorString <span class="sh_symbol">=</span> verificationErrors<span class="sh_symbol">.</span><span class="sh_function">toString</span><span class="sh_symbol">();</span></li><li>    <span class="sh_keyword">if</span> <span class="sh_symbol">(!</span><span class="sh_string">""</span><span class="sh_symbol">.</span><span class="sh_function">equals</span><span class="sh_symbol">(</span>verificationErrorString<span class="sh_symbol">))</span> <span class="sh_cbracket">{</span></li><li>      <span class="sh_function">fail</span><span class="sh_symbol">(</span>verificationErrorString<span class="sh_symbol">);</span></li><li>    <span class="sh_cbracket">}</span></li><li>  <span class="sh_cbracket">}</span></li><li><span style="display:none;">&nbsp;</span></li><li>  <span class="sh_keyword">private</span> boolean <span class="sh_function">isElementPresent</span><span class="sh_symbol">(</span>By by<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span></li><li>    <span class="sh_keyword">try</span> <span class="sh_cbracket">{</span></li><li>      driver<span class="sh_symbol">.</span><span class="sh_function">findElement</span><span class="sh_symbol">(</span>by<span class="sh_symbol">);</span></li><li>      <span class="sh_keyword">return</span> <span class="sh_keyword">true</span><span class="sh_symbol">;</span></li><li>    <span class="sh_cbracket">}</span> <span class="sh_keyword">catch</span> <span class="sh_symbol">(</span>NoSuchElementException e<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span></li><li>      <span class="sh_keyword">return</span> <span class="sh_keyword">false</span><span class="sh_symbol">;</span></li><li>    <span class="sh_cbracket">}</span></li><li>  <span class="sh_cbracket">}</span></li><li><span style="display:none;">&nbsp;</span></li><li>  <span class="sh_keyword">private</span> boolean <span class="sh_function">isAlertPresent</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span></li><li>    <span class="sh_keyword">try</span> <span class="sh_cbracket">{</span></li><li>      driver<span class="sh_symbol">.</span><span class="sh_function">switchTo</span><span class="sh_symbol">().</span><span class="sh_function">alert</span><span class="sh_symbol">();</span></li><li>      <span class="sh_keyword">return</span> <span class="sh_keyword">true</span><span class="sh_symbol">;</span></li><li>    <span class="sh_cbracket">}</span> <span class="sh_keyword">catch</span> <span class="sh_symbol">(</span>NoAlertPresentException e<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span></li><li>      <span class="sh_keyword">return</span> <span class="sh_keyword">false</span><span class="sh_symbol">;</span></li><li>    <span class="sh_cbracket">}</span></li><li>  <span class="sh_cbracket">}</span></li><li><span style="display:none;">&nbsp;</span></li><li>  <span class="sh_keyword">private</span> <span class="sh_predef_func">String</span> <span class="sh_function">closeAlertAndGetItsText</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span></li><li>    <span class="sh_keyword">try</span> <span class="sh_cbracket">{</span></li><li>      Alert alert <span class="sh_symbol">=</span> driver<span class="sh_symbol">.</span><span class="sh_function">switchTo</span><span class="sh_symbol">().</span><span class="sh_function">alert</span><span class="sh_symbol">();</span></li><li>      <span class="sh_predef_func">String</span> alertText <span class="sh_symbol">=</span> alert<span class="sh_symbol">.</span><span class="sh_function">getText</span><span class="sh_symbol">();</span></li><li>      <span class="sh_keyword">if</span> <span class="sh_symbol">(</span>acceptNextAlert<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span></li><li>        alert<span class="sh_symbol">.</span><span class="sh_function">accept</span><span class="sh_symbol">();</span></li><li>      <span class="sh_cbracket">}</span> <span class="sh_keyword">else</span> <span class="sh_cbracket">{</span></li><li>        alert<span class="sh_symbol">.</span><span class="sh_function">dismiss</span><span class="sh_symbol">();</span></li><li>      <span class="sh_cbracket">}</span></li><li>      <span class="sh_keyword">return</span> alertText<span class="sh_symbol">;</span></li><li>    <span class="sh_cbracket">}</span> <span class="sh_keyword">finally</span> <span class="sh_cbracket">{</span></li><li>      acceptNextAlert <span class="sh_symbol">=</span> <span class="sh_keyword">true</span><span class="sh_symbol">;</span></li><li>    <span class="sh_cbracket">}</span></li><li>  <span class="sh_cbracket">}</span></li><li><span class="sh_cbracket">}</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">package day04;

import java.util.regex.Pattern;
import java.util.concurrent.TimeUnit;
import org.junit.*;
import static org.junit.Assert.*;
import static org.hamcrest.CoreMatchers.*;
import org.openqa.selenium.*;
import org.openqa.selenium.firefox.FirefoxDriver;
import org.openqa.selenium.support.ui.Select;

public class IEMessage {
  private WebDriver driver;
  private String baseUrl;
  private boolean acceptNextAlert = true;
  private StringBuffer verificationErrors = new StringBuffer();

  @Before
  public void setUp() throws Exception {
    driver = new FirefoxDriver();
    baseUrl = "http://localhost/";
    driver.manage().timeouts().implicitlyWait(30, TimeUnit.SECONDS);
  }

  @Test
  public void testUntitled() throws Exception {
	//因为是绝对路径的url，所以删除baseUrl+的部分
    driver.get("file:///E:/Selenium/example/message.html");
    driver.findElement(By.name("name")).clear();
    driver.findElement(By.name("name")).sendKeys("jack");
    driver.findElement(By.name("e-mail")).clear();
    driver.findElement(By.name("e-mail")).sendKeys("jack@163.com");
    driver.findElement(By.name("comments")).clear();
    driver.findElement(By.name("comments")).sendKeys("Hello,jack!");
    driver.findElement(By.cssSelector("input[type=\"submit\"]")).click();
    assertEquals("留言簿", driver.getTitle());
    assertEquals("完 成", driver.findElement(By.cssSelector("input[type=\"submit\"]")).getAttribute("value"));
  }

  @After
  public void tearDown() throws Exception {
    driver.quit();
    String verificationErrorString = verificationErrors.toString();
    if (!"".equals(verificationErrorString)) {
      fail(verificationErrorString);
    }
  }

  private boolean isElementPresent(By by) {
    try {
      driver.findElement(by);
      return true;
    } catch (NoSuchElementException e) {
      return false;
    }
  }

  private boolean isAlertPresent() {
    try {
      driver.switchTo().alert();
      return true;
    } catch (NoAlertPresentException e) {
      return false;
    }
  }

  private String closeAlertAndGetItsText() {
    try {
      Alert alert = driver.switchTo().alert();
      String alertText = alert.getText();
      if (acceptNextAlert) {
        alert.accept();
      } else {
        alert.dismiss();
      }
      return alertText;
    } finally {
      acceptNextAlert = true;
    }
  }
}
</pre></div></div>
      <p class="number">步骤二：准备IE浏览器运行环境</p>
      <p>确认已经默认安装IE浏览器。</p>
      <p>在Selenium官网下载IE浏览器的驱动文件IEDriverServer.exe，放在指定的磁盘目录下（如C盘根目录），如下图-4所示：</p>
      <div class="image">
        <img src="./TEST SELENIUM DAY04_w_files/image004.png">
        <p>图 - 4</p>
      </div>
      <p class="number">步骤三：修改调整代码</p>
      <p>在IEMessage的Class，找到注解为@Before的setUp方法，修改启动浏览器的部分，修改为启动IE浏览器的代码，导入相关的类InternetExplorerDriver。</p>
      <p>注意：启动IE浏览器需要单独指定IEDriverServer.exe的路径，需要设置的系统属性为webdriver.ie.driver。</p>
      <p>代码如下所示：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/TESTING/TSDTN201801/SELENIUM/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/TESTING/TSDTN201801/SELENIUM/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/TESTING/TSDTN201801/SELENIUM/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li>package day04<span class="sh_symbol">;</span></li><li><span style="display:none;">&nbsp;</span></li><li>import java<span class="sh_symbol">.</span>util<span class="sh_symbol">.</span>regex<span class="sh_symbol">.</span>Pattern<span class="sh_symbol">;</span></li><li>import java<span class="sh_symbol">.</span>util<span class="sh_symbol">.</span>concurrent<span class="sh_symbol">.</span>TimeUnit<span class="sh_symbol">;</span></li><li>import org<span class="sh_symbol">.</span>junit<span class="sh_symbol">.*;</span></li><li>import <span class="sh_keyword">static</span> org<span class="sh_symbol">.</span>junit<span class="sh_symbol">.</span>Assert<span class="sh_symbol">.*;</span></li><li>import <span class="sh_keyword">static</span> org<span class="sh_symbol">.</span>hamcrest<span class="sh_symbol">.</span>CoreMatchers<span class="sh_symbol">.*;</span></li><li>import org<span class="sh_symbol">.</span>openqa<span class="sh_symbol">.</span>selenium<span class="sh_symbol">.*;</span></li><li>import org<span class="sh_symbol">.</span>openqa<span class="sh_symbol">.</span>selenium<span class="sh_symbol">.</span>firefox<span class="sh_symbol">.</span>FirefoxDriver<span class="sh_symbol">;</span></li><li class="bold_code">import org<span class="sh_symbol">.</span>openqa<span class="sh_symbol">.</span>selenium<span class="sh_symbol">.</span>ie<span class="sh_symbol">.</span>InternetExplorerDriver<span class="sh_symbol">;</span></li><li>import org<span class="sh_symbol">.</span>openqa<span class="sh_symbol">.</span>selenium<span class="sh_symbol">.</span>support<span class="sh_symbol">.</span>ui<span class="sh_symbol">.</span>Select<span class="sh_symbol">;</span></li><li><span style="display:none;">&nbsp;</span></li><li><span class="sh_keyword">public</span> <span class="sh_keyword">class</span> IEMessage<span class="sh_cbracket">{</span></li><li>  <span class="sh_keyword">private</span> WebDriver driver<span class="sh_symbol">;</span></li><li>  <span class="sh_keyword">private</span> <span class="sh_predef_func">String</span> baseUrl<span class="sh_symbol">;</span></li><li>  <span class="sh_keyword">private</span> boolean acceptNextAlert <span class="sh_symbol">=</span> <span class="sh_keyword">true</span><span class="sh_symbol">;</span></li><li>  <span class="sh_keyword">private</span> StringBuffer verificationErrors <span class="sh_symbol">=</span> <span class="sh_keyword">new</span> <span class="sh_function">StringBuffer</span><span class="sh_symbol">();</span></li><li><span style="display:none;">&nbsp;</span></li><li>  @Before</li><li>  <span class="sh_keyword">public</span> void <span class="sh_function">setUp</span><span class="sh_symbol">()</span> <span class="sh_keyword">throws</span> Exception <span class="sh_cbracket">{</span></li><li class="bold_code">&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//启动IE浏览器</span></li><li class="bold_code">&nbsp;&nbsp;&nbsp;&nbsp;System<span class="sh_symbol">.</span><span class="sh_function">setProperty</span><span class="sh_symbol">(</span><span class="sh_string">"webdriver.ie.driver"</span><span class="sh_symbol">,</span> <span class="sh_string">"C:</span><span class="sh_specialchar">\\</span><span class="sh_string">IEDriverServer.exe"</span><span class="sh_symbol">);</span></li><li class="bold_code">    driver <span class="sh_symbol">=</span> <span class="sh_keyword">new</span> <span class="sh_function">InternetExplorerDriver</span><span class="sh_symbol">();</span></li><li>    baseUrl <span class="sh_symbol">=</span> <span class="sh_string">"http://localhost/"</span><span class="sh_symbol">;</span></li><li>    driver<span class="sh_symbol">.</span><span class="sh_function">manage</span><span class="sh_symbol">().</span><span class="sh_function">timeouts</span><span class="sh_symbol">().</span><span class="sh_function">implicitlyWait</span><span class="sh_symbol">(</span><span class="sh_number">30</span><span class="sh_symbol">,</span> TimeUnit<span class="sh_symbol">.</span>SECONDS<span class="sh_symbol">);</span></li><li>  <span class="sh_cbracket">}</span></li><li><span style="display:none;">&nbsp;</span></li><li>  @Test</li><li>  <span class="sh_keyword">public</span> void <span class="sh_function">testUntitled</span><span class="sh_symbol">()</span> <span class="sh_keyword">throws</span> Exception <span class="sh_cbracket">{</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//因为是绝对路径的url，所以删除baseUrl+的部分</span></li><li>    driver<span class="sh_symbol">.</span><span class="sh_function">get</span><span class="sh_symbol">(</span><span class="sh_string">"file:///E:/Selenium/example/message.html"</span><span class="sh_symbol">);</span></li><li>    driver<span class="sh_symbol">.</span><span class="sh_function">findElement</span><span class="sh_symbol">(</span>By<span class="sh_symbol">.</span><span class="sh_function">name</span><span class="sh_symbol">(</span><span class="sh_string">"name"</span><span class="sh_symbol">)).</span><span class="sh_function">clear</span><span class="sh_symbol">();</span></li><li>    driver<span class="sh_symbol">.</span><span class="sh_function">findElement</span><span class="sh_symbol">(</span>By<span class="sh_symbol">.</span><span class="sh_function">name</span><span class="sh_symbol">(</span><span class="sh_string">"name"</span><span class="sh_symbol">)).</span><span class="sh_function">sendKeys</span><span class="sh_symbol">(</span><span class="sh_string">"jack"</span><span class="sh_symbol">);</span></li><li>    driver<span class="sh_symbol">.</span><span class="sh_function">findElement</span><span class="sh_symbol">(</span>By<span class="sh_symbol">.</span><span class="sh_function">name</span><span class="sh_symbol">(</span><span class="sh_string">"e-mail"</span><span class="sh_symbol">)).</span><span class="sh_function">clear</span><span class="sh_symbol">();</span></li><li>    driver<span class="sh_symbol">.</span><span class="sh_function">findElement</span><span class="sh_symbol">(</span>By<span class="sh_symbol">.</span><span class="sh_function">name</span><span class="sh_symbol">(</span><span class="sh_string">"e-mail"</span><span class="sh_symbol">)).</span><span class="sh_function">sendKeys</span><span class="sh_symbol">(</span><span class="sh_string">"jack@163.com"</span><span class="sh_symbol">);</span></li><li>    driver<span class="sh_symbol">.</span><span class="sh_function">findElement</span><span class="sh_symbol">(</span>By<span class="sh_symbol">.</span><span class="sh_function">name</span><span class="sh_symbol">(</span><span class="sh_string">"comments"</span><span class="sh_symbol">)).</span><span class="sh_function">clear</span><span class="sh_symbol">();</span></li><li>    driver<span class="sh_symbol">.</span><span class="sh_function">findElement</span><span class="sh_symbol">(</span>By<span class="sh_symbol">.</span><span class="sh_function">name</span><span class="sh_symbol">(</span><span class="sh_string">"comments"</span><span class="sh_symbol">)).</span><span class="sh_function">sendKeys</span><span class="sh_symbol">(</span><span class="sh_string">"Hello,jack!"</span><span class="sh_symbol">);</span></li><li>    driver<span class="sh_symbol">.</span><span class="sh_function">findElement</span><span class="sh_symbol">(</span>By<span class="sh_symbol">.</span><span class="sh_function">cssSelector</span><span class="sh_symbol">(</span><span class="sh_string">"input[type=</span><span class="sh_specialchar">\"</span><span class="sh_string">submit</span><span class="sh_specialchar">\"</span><span class="sh_string">]"</span><span class="sh_symbol">)).</span><span class="sh_function">click</span><span class="sh_symbol">();</span></li><li>    <span class="sh_function">assertEquals</span><span class="sh_symbol">(</span><span class="sh_string">"留言簿"</span><span class="sh_symbol">,</span> driver<span class="sh_symbol">.</span><span class="sh_function">getTitle</span><span class="sh_symbol">());</span></li><li>    <span class="sh_function">assertEquals</span><span class="sh_symbol">(</span><span class="sh_string">"完 成"</span><span class="sh_symbol">,</span> driver<span class="sh_symbol">.</span><span class="sh_function">findElement</span><span class="sh_symbol">(</span>By<span class="sh_symbol">.</span><span class="sh_function">cssSelector</span><span class="sh_symbol">(</span><span class="sh_string">"input[type=</span><span class="sh_specialchar">\"</span><span class="sh_string">submit</span></li><li><span style="display:none;">&nbsp;</span></li><li><span class="sh_specialchar">\"</span><span class="sh_string">]"</span><span class="sh_symbol">)).</span><span class="sh_function">getAttribute</span><span class="sh_symbol">(</span><span class="sh_string">"value"</span><span class="sh_symbol">));</span></li><li>  <span class="sh_cbracket">}</span></li><li><span style="display:none;">&nbsp;</span></li><li>  @After</li><li>  <span class="sh_keyword">public</span> void <span class="sh_function">tearDown</span><span class="sh_symbol">()</span> <span class="sh_keyword">throws</span> Exception <span class="sh_cbracket">{</span></li><li>    driver<span class="sh_symbol">.</span><span class="sh_function">quit</span><span class="sh_symbol">();</span></li><li>    <span class="sh_predef_func">String</span> verificationErrorString <span class="sh_symbol">=</span> verificationErrors<span class="sh_symbol">.</span><span class="sh_function">toString</span><span class="sh_symbol">();</span></li><li>    <span class="sh_keyword">if</span> <span class="sh_symbol">(!</span><span class="sh_string">""</span><span class="sh_symbol">.</span><span class="sh_function">equals</span><span class="sh_symbol">(</span>verificationErrorString<span class="sh_symbol">))</span> <span class="sh_cbracket">{</span></li><li>      <span class="sh_function">fail</span><span class="sh_symbol">(</span>verificationErrorString<span class="sh_symbol">);</span></li><li>    <span class="sh_cbracket">}</span></li><li>  <span class="sh_cbracket">}</span></li><li><span style="display:none;">&nbsp;</span></li><li>  <span class="sh_keyword">private</span> boolean <span class="sh_function">isElementPresent</span><span class="sh_symbol">(</span>By by<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span></li><li>    <span class="sh_keyword">try</span> <span class="sh_cbracket">{</span></li><li>      driver<span class="sh_symbol">.</span><span class="sh_function">findElement</span><span class="sh_symbol">(</span>by<span class="sh_symbol">);</span></li><li>      <span class="sh_keyword">return</span> <span class="sh_keyword">true</span><span class="sh_symbol">;</span></li><li>    <span class="sh_cbracket">}</span> <span class="sh_keyword">catch</span> <span class="sh_symbol">(</span>NoSuchElementException e<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span></li><li>      <span class="sh_keyword">return</span> <span class="sh_keyword">false</span><span class="sh_symbol">;</span></li><li>    <span class="sh_cbracket">}</span></li><li>  <span class="sh_cbracket">}</span></li><li><span style="display:none;">&nbsp;</span></li><li>  <span class="sh_keyword">private</span> boolean <span class="sh_function">isAlertPresent</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span></li><li>    <span class="sh_keyword">try</span> <span class="sh_cbracket">{</span></li><li>      driver<span class="sh_symbol">.</span><span class="sh_function">switchTo</span><span class="sh_symbol">().</span><span class="sh_function">alert</span><span class="sh_symbol">();</span></li><li>      <span class="sh_keyword">return</span> <span class="sh_keyword">true</span><span class="sh_symbol">;</span></li><li>    <span class="sh_cbracket">}</span> <span class="sh_keyword">catch</span> <span class="sh_symbol">(</span>NoAlertPresentException e<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span></li><li>      <span class="sh_keyword">return</span> <span class="sh_keyword">false</span><span class="sh_symbol">;</span></li><li>    <span class="sh_cbracket">}</span></li><li>  <span class="sh_cbracket">}</span></li><li><span style="display:none;">&nbsp;</span></li><li>  <span class="sh_keyword">private</span> <span class="sh_predef_func">String</span> <span class="sh_function">closeAlertAndGetItsText</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span></li><li>    <span class="sh_keyword">try</span> <span class="sh_cbracket">{</span></li><li>      Alert alert <span class="sh_symbol">=</span> driver<span class="sh_symbol">.</span><span class="sh_function">switchTo</span><span class="sh_symbol">().</span><span class="sh_function">alert</span><span class="sh_symbol">();</span></li><li>      <span class="sh_predef_func">String</span> alertText <span class="sh_symbol">=</span> alert<span class="sh_symbol">.</span><span class="sh_function">getText</span><span class="sh_symbol">();</span></li><li>      <span class="sh_keyword">if</span> <span class="sh_symbol">(</span>acceptNextAlert<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span></li><li>        alert<span class="sh_symbol">.</span><span class="sh_function">accept</span><span class="sh_symbol">();</span></li><li>      <span class="sh_cbracket">}</span> <span class="sh_keyword">else</span> <span class="sh_cbracket">{</span></li><li>        alert<span class="sh_symbol">.</span><span class="sh_function">dismiss</span><span class="sh_symbol">();</span></li><li>      <span class="sh_cbracket">}</span></li><li>      <span class="sh_keyword">return</span> alertText<span class="sh_symbol">;</span></li><li>    <span class="sh_cbracket">}</span> <span class="sh_keyword">finally</span> <span class="sh_cbracket">{</span></li><li>      acceptNextAlert <span class="sh_symbol">=</span> <span class="sh_keyword">true</span><span class="sh_symbol">;</span></li><li>    <span class="sh_cbracket">}</span></li><li>  <span class="sh_cbracket">}</span></li><li><span class="sh_cbracket">}</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">package day04;

import java.util.regex.Pattern;
import java.util.concurrent.TimeUnit;
import org.junit.*;
import static org.junit.Assert.*;
import static org.hamcrest.CoreMatchers.*;
import org.openqa.selenium.*;
import org.openqa.selenium.firefox.FirefoxDriver;
#cold_boldimport org.openqa.selenium.ie.InternetExplorerDriver;
import org.openqa.selenium.support.ui.Select;

public class IEMessage{
  private WebDriver driver;
  private String baseUrl;
  private boolean acceptNextAlert = true;
  private StringBuffer verificationErrors = new StringBuffer();

  @Before
  public void setUp() throws Exception {
#cold_bold	//启动IE浏览器
#cold_bold	System.setProperty("webdriver.ie.driver", "C:\\IEDriverServer.exe");
#cold_bold    driver = new InternetExplorerDriver();
    baseUrl = "http://localhost/";
    driver.manage().timeouts().implicitlyWait(30, TimeUnit.SECONDS);
  }

  @Test
  public void testUntitled() throws Exception {
	//因为是绝对路径的url，所以删除baseUrl+的部分
    driver.get("file:///E:/Selenium/example/message.html");
    driver.findElement(By.name("name")).clear();
    driver.findElement(By.name("name")).sendKeys("jack");
    driver.findElement(By.name("e-mail")).clear();
    driver.findElement(By.name("e-mail")).sendKeys("jack@163.com");
    driver.findElement(By.name("comments")).clear();
    driver.findElement(By.name("comments")).sendKeys("Hello,jack!");
    driver.findElement(By.cssSelector("input[type=\"submit\"]")).click();
    assertEquals("留言簿", driver.getTitle());
    assertEquals("完 成", driver.findElement(By.cssSelector("input[type=\"submit

\"]")).getAttribute("value"));
  }

  @After
  public void tearDown() throws Exception {
    driver.quit();
    String verificationErrorString = verificationErrors.toString();
    if (!"".equals(verificationErrorString)) {
      fail(verificationErrorString);
    }
  }

  private boolean isElementPresent(By by) {
    try {
      driver.findElement(by);
      return true;
    } catch (NoSuchElementException e) {
      return false;
    }
  }

  private boolean isAlertPresent() {
    try {
      driver.switchTo().alert();
      return true;
    } catch (NoAlertPresentException e) {
      return false;
    }
  }

  private String closeAlertAndGetItsText() {
    try {
      Alert alert = driver.switchTo().alert();
      String alertText = alert.getText();
      if (acceptNextAlert) {
        alert.accept();
      } else {
        alert.dismiss();
      }
      return alertText;
    } finally {
      acceptNextAlert = true;
    }
  }
}
</pre></div></div>
      <p class="number">步骤四：设置IE浏览器</p>
      <p>需要设置IE的Internet选项中，高级设置部分，勾选“允许活动内容在我的计算机的文件中运行”的复选框，重启IE浏览器后生效。</p>
      <div class="image">
        <img src="./TEST SELENIUM DAY04_w_files/image005.png">
        <p>图 - 5</p>
      </div>
      <p class="number">步骤五：运行调试代码</p>
      <p>在该类上点击右键，选择Run As\JUnit Test来运行JUnit测试用例代码，查看被测系统被启动，并且执行相应的自动化测试步骤。</p>
      <p>查看JUnit视图中的运行状态条，如果为绿色，代表运行成功，如果为红色，需要查看Failure Trace确认和定位问题。</p>
      <h3>2.4 完整代码</h3>
      <p>本案例中，IEMessage类的完整代码如下所示：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap" style="display: none;"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/TESTING/TSDTN201801/SELENIUM/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/TESTING/TSDTN201801/SELENIUM/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/TESTING/TSDTN201801/SELENIUM/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="hide sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li>package day04<span class="sh_symbol">;</span></li><li><span style="display:none;">&nbsp;</span></li><li>import java<span class="sh_symbol">.</span>util<span class="sh_symbol">.</span>regex<span class="sh_symbol">.</span>Pattern<span class="sh_symbol">;</span></li><li>import java<span class="sh_symbol">.</span>util<span class="sh_symbol">.</span>concurrent<span class="sh_symbol">.</span>TimeUnit<span class="sh_symbol">;</span></li><li>import org<span class="sh_symbol">.</span>junit<span class="sh_symbol">.*;</span></li><li>import <span class="sh_keyword">static</span> org<span class="sh_symbol">.</span>junit<span class="sh_symbol">.</span>Assert<span class="sh_symbol">.*;</span></li><li>import <span class="sh_keyword">static</span> org<span class="sh_symbol">.</span>hamcrest<span class="sh_symbol">.</span>CoreMatchers<span class="sh_symbol">.*;</span></li><li>import org<span class="sh_symbol">.</span>openqa<span class="sh_symbol">.</span>selenium<span class="sh_symbol">.*;</span></li><li>import org<span class="sh_symbol">.</span>openqa<span class="sh_symbol">.</span>selenium<span class="sh_symbol">.</span>firefox<span class="sh_symbol">.</span>FirefoxDriver<span class="sh_symbol">;</span></li><li>import org<span class="sh_symbol">.</span>openqa<span class="sh_symbol">.</span>selenium<span class="sh_symbol">.</span>ie<span class="sh_symbol">.</span>InternetExplorerDriver<span class="sh_symbol">;</span></li><li>import org<span class="sh_symbol">.</span>openqa<span class="sh_symbol">.</span>selenium<span class="sh_symbol">.</span>support<span class="sh_symbol">.</span>ui<span class="sh_symbol">.</span>Select<span class="sh_symbol">;</span></li><li><span style="display:none;">&nbsp;</span></li><li><span class="sh_keyword">public</span> <span class="sh_keyword">class</span> IEMessage <span class="sh_cbracket">{</span></li><li>  <span class="sh_keyword">private</span> WebDriver driver<span class="sh_symbol">;</span></li><li>  <span class="sh_keyword">private</span> <span class="sh_predef_func">String</span> baseUrl<span class="sh_symbol">;</span></li><li>  <span class="sh_keyword">private</span> boolean acceptNextAlert <span class="sh_symbol">=</span> <span class="sh_keyword">true</span><span class="sh_symbol">;</span></li><li>  <span class="sh_keyword">private</span> StringBuffer verificationErrors <span class="sh_symbol">=</span> <span class="sh_keyword">new</span> <span class="sh_function">StringBuffer</span><span class="sh_symbol">();</span></li><li><span style="display:none;">&nbsp;</span></li><li>  @Before</li><li>  <span class="sh_keyword">public</span> void <span class="sh_function">setUp</span><span class="sh_symbol">()</span> <span class="sh_keyword">throws</span> Exception <span class="sh_cbracket">{</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//启动IE浏览器</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;System<span class="sh_symbol">.</span><span class="sh_function">setProperty</span><span class="sh_symbol">(</span><span class="sh_string">"webdriver.ie.driver"</span><span class="sh_symbol">,</span> <span class="sh_string">"C:</span><span class="sh_specialchar">\\</span><span class="sh_string">IEDriverServer.exe"</span><span class="sh_symbol">);</span></li><li>    driver <span class="sh_symbol">=</span> <span class="sh_keyword">new</span> <span class="sh_function">InternetExplorerDriver</span><span class="sh_symbol">();</span></li><li>    baseUrl <span class="sh_symbol">=</span> <span class="sh_string">"http://localhost/"</span><span class="sh_symbol">;</span></li><li>    driver<span class="sh_symbol">.</span><span class="sh_function">manage</span><span class="sh_symbol">().</span><span class="sh_function">timeouts</span><span class="sh_symbol">().</span><span class="sh_function">implicitlyWait</span><span class="sh_symbol">(</span><span class="sh_number">30</span><span class="sh_symbol">,</span> TimeUnit<span class="sh_symbol">.</span>SECONDS<span class="sh_symbol">);</span></li><li>  <span class="sh_cbracket">}</span></li><li><span style="display:none;">&nbsp;</span></li><li>  @Test</li><li>  <span class="sh_keyword">public</span> void <span class="sh_function">testUntitled</span><span class="sh_symbol">()</span> <span class="sh_keyword">throws</span> Exception <span class="sh_cbracket">{</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//因为是绝对路径的url，所以删除baseUrl+的部分</span></li><li>    driver<span class="sh_symbol">.</span><span class="sh_function">get</span><span class="sh_symbol">(</span><span class="sh_string">"file:///E:/Selenium/example/message.html"</span><span class="sh_symbol">);</span></li><li>    driver<span class="sh_symbol">.</span><span class="sh_function">findElement</span><span class="sh_symbol">(</span>By<span class="sh_symbol">.</span><span class="sh_function">name</span><span class="sh_symbol">(</span><span class="sh_string">"name"</span><span class="sh_symbol">)).</span><span class="sh_function">clear</span><span class="sh_symbol">();</span></li><li>    driver<span class="sh_symbol">.</span><span class="sh_function">findElement</span><span class="sh_symbol">(</span>By<span class="sh_symbol">.</span><span class="sh_function">name</span><span class="sh_symbol">(</span><span class="sh_string">"name"</span><span class="sh_symbol">)).</span><span class="sh_function">sendKeys</span><span class="sh_symbol">(</span><span class="sh_string">"jack"</span><span class="sh_symbol">);</span></li><li>    driver<span class="sh_symbol">.</span><span class="sh_function">findElement</span><span class="sh_symbol">(</span>By<span class="sh_symbol">.</span><span class="sh_function">name</span><span class="sh_symbol">(</span><span class="sh_string">"e-mail"</span><span class="sh_symbol">)).</span><span class="sh_function">clear</span><span class="sh_symbol">();</span></li><li>    driver<span class="sh_symbol">.</span><span class="sh_function">findElement</span><span class="sh_symbol">(</span>By<span class="sh_symbol">.</span><span class="sh_function">name</span><span class="sh_symbol">(</span><span class="sh_string">"e-mail"</span><span class="sh_symbol">)).</span><span class="sh_function">sendKeys</span><span class="sh_symbol">(</span><span class="sh_string">"jack@163.com"</span><span class="sh_symbol">);</span></li><li>    driver<span class="sh_symbol">.</span><span class="sh_function">findElement</span><span class="sh_symbol">(</span>By<span class="sh_symbol">.</span><span class="sh_function">name</span><span class="sh_symbol">(</span><span class="sh_string">"comments"</span><span class="sh_symbol">)).</span><span class="sh_function">clear</span><span class="sh_symbol">();</span></li><li>    driver<span class="sh_symbol">.</span><span class="sh_function">findElement</span><span class="sh_symbol">(</span>By<span class="sh_symbol">.</span><span class="sh_function">name</span><span class="sh_symbol">(</span><span class="sh_string">"comments"</span><span class="sh_symbol">)).</span><span class="sh_function">sendKeys</span><span class="sh_symbol">(</span><span class="sh_string">"Hello,jack!"</span><span class="sh_symbol">);</span></li><li>    driver<span class="sh_symbol">.</span><span class="sh_function">findElement</span><span class="sh_symbol">(</span>By<span class="sh_symbol">.</span><span class="sh_function">cssSelector</span><span class="sh_symbol">(</span><span class="sh_string">"input[type=</span><span class="sh_specialchar">\"</span><span class="sh_string">submit</span><span class="sh_specialchar">\"</span><span class="sh_string">]"</span><span class="sh_symbol">)).</span><span class="sh_function">click</span><span class="sh_symbol">();</span></li><li>    <span class="sh_function">assertEquals</span><span class="sh_symbol">(</span><span class="sh_string">"留言簿"</span><span class="sh_symbol">,</span> driver<span class="sh_symbol">.</span><span class="sh_function">getTitle</span><span class="sh_symbol">());</span></li><li>    <span class="sh_function">assertEquals</span><span class="sh_symbol">(</span><span class="sh_string">"完 成"</span><span class="sh_symbol">,</span> driver<span class="sh_symbol">.</span><span class="sh_function">findElement</span><span class="sh_symbol">(</span>By<span class="sh_symbol">.</span><span class="sh_function">cssSelector</span><span class="sh_symbol">(</span><span class="sh_string">"input[type=</span><span class="sh_specialchar">\"</span><span class="sh_string">submit</span></li><li><span style="display:none;">&nbsp;</span></li><li><span class="sh_specialchar">\"</span><span class="sh_string">]"</span><span class="sh_symbol">)).</span><span class="sh_function">getAttribute</span><span class="sh_symbol">(</span><span class="sh_string">"value"</span><span class="sh_symbol">));</span></li><li>  <span class="sh_cbracket">}</span></li><li><span style="display:none;">&nbsp;</span></li><li>  @After</li><li>  <span class="sh_keyword">public</span> void <span class="sh_function">tearDown</span><span class="sh_symbol">()</span> <span class="sh_keyword">throws</span> Exception <span class="sh_cbracket">{</span></li><li>    driver<span class="sh_symbol">.</span><span class="sh_function">quit</span><span class="sh_symbol">();</span></li><li>    <span class="sh_predef_func">String</span> verificationErrorString <span class="sh_symbol">=</span> verificationErrors<span class="sh_symbol">.</span><span class="sh_function">toString</span><span class="sh_symbol">();</span></li><li>    <span class="sh_keyword">if</span> <span class="sh_symbol">(!</span><span class="sh_string">""</span><span class="sh_symbol">.</span><span class="sh_function">equals</span><span class="sh_symbol">(</span>verificationErrorString<span class="sh_symbol">))</span> <span class="sh_cbracket">{</span></li><li>      <span class="sh_function">fail</span><span class="sh_symbol">(</span>verificationErrorString<span class="sh_symbol">);</span></li><li>    <span class="sh_cbracket">}</span></li><li>  <span class="sh_cbracket">}</span></li><li><span style="display:none;">&nbsp;</span></li><li>  <span class="sh_keyword">private</span> boolean <span class="sh_function">isElementPresent</span><span class="sh_symbol">(</span>By by<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span></li><li>    <span class="sh_keyword">try</span> <span class="sh_cbracket">{</span></li><li>      driver<span class="sh_symbol">.</span><span class="sh_function">findElement</span><span class="sh_symbol">(</span>by<span class="sh_symbol">);</span></li><li>      <span class="sh_keyword">return</span> <span class="sh_keyword">true</span><span class="sh_symbol">;</span></li><li>    <span class="sh_cbracket">}</span> <span class="sh_keyword">catch</span> <span class="sh_symbol">(</span>NoSuchElementException e<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span></li><li>      <span class="sh_keyword">return</span> <span class="sh_keyword">false</span><span class="sh_symbol">;</span></li><li>    <span class="sh_cbracket">}</span></li><li>  <span class="sh_cbracket">}</span></li><li><span style="display:none;">&nbsp;</span></li><li>  <span class="sh_keyword">private</span> boolean <span class="sh_function">isAlertPresent</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span></li><li>    <span class="sh_keyword">try</span> <span class="sh_cbracket">{</span></li><li>      driver<span class="sh_symbol">.</span><span class="sh_function">switchTo</span><span class="sh_symbol">().</span><span class="sh_function">alert</span><span class="sh_symbol">();</span></li><li>      <span class="sh_keyword">return</span> <span class="sh_keyword">true</span><span class="sh_symbol">;</span></li><li>    <span class="sh_cbracket">}</span> <span class="sh_keyword">catch</span> <span class="sh_symbol">(</span>NoAlertPresentException e<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span></li><li>      <span class="sh_keyword">return</span> <span class="sh_keyword">false</span><span class="sh_symbol">;</span></li><li>    <span class="sh_cbracket">}</span></li><li>  <span class="sh_cbracket">}</span></li><li><span style="display:none;">&nbsp;</span></li><li>  <span class="sh_keyword">private</span> <span class="sh_predef_func">String</span> <span class="sh_function">closeAlertAndGetItsText</span><span class="sh_symbol">()</span> <span class="sh_cbracket">{</span></li><li>    <span class="sh_keyword">try</span> <span class="sh_cbracket">{</span></li><li>      Alert alert <span class="sh_symbol">=</span> driver<span class="sh_symbol">.</span><span class="sh_function">switchTo</span><span class="sh_symbol">().</span><span class="sh_function">alert</span><span class="sh_symbol">();</span></li><li>      <span class="sh_predef_func">String</span> alertText <span class="sh_symbol">=</span> alert<span class="sh_symbol">.</span><span class="sh_function">getText</span><span class="sh_symbol">();</span></li><li>      <span class="sh_keyword">if</span> <span class="sh_symbol">(</span>acceptNextAlert<span class="sh_symbol">)</span> <span class="sh_cbracket">{</span></li><li>        alert<span class="sh_symbol">.</span><span class="sh_function">accept</span><span class="sh_symbol">();</span></li><li>      <span class="sh_cbracket">}</span> <span class="sh_keyword">else</span> <span class="sh_cbracket">{</span></li><li>        alert<span class="sh_symbol">.</span><span class="sh_function">dismiss</span><span class="sh_symbol">();</span></li><li>      <span class="sh_cbracket">}</span></li><li>      <span class="sh_keyword">return</span> alertText<span class="sh_symbol">;</span></li><li>    <span class="sh_cbracket">}</span> <span class="sh_keyword">finally</span> <span class="sh_cbracket">{</span></li><li>      acceptNextAlert <span class="sh_symbol">=</span> <span class="sh_keyword">true</span><span class="sh_symbol">;</span></li><li>    <span class="sh_cbracket">}</span></li><li>  <span class="sh_cbracket">}</span></li><li><span class="sh_cbracket">}</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">package day04;

import java.util.regex.Pattern;
import java.util.concurrent.TimeUnit;
import org.junit.*;
import static org.junit.Assert.*;
import static org.hamcrest.CoreMatchers.*;
import org.openqa.selenium.*;
import org.openqa.selenium.firefox.FirefoxDriver;
import org.openqa.selenium.ie.InternetExplorerDriver;
import org.openqa.selenium.support.ui.Select;

public class IEMessage {
  private WebDriver driver;
  private String baseUrl;
  private boolean acceptNextAlert = true;
  private StringBuffer verificationErrors = new StringBuffer();

  @Before
  public void setUp() throws Exception {
	//启动IE浏览器
	System.setProperty("webdriver.ie.driver", "C:\\IEDriverServer.exe");
    driver = new InternetExplorerDriver();
    baseUrl = "http://localhost/";
    driver.manage().timeouts().implicitlyWait(30, TimeUnit.SECONDS);
  }

  @Test
  public void testUntitled() throws Exception {
	//因为是绝对路径的url，所以删除baseUrl+的部分
    driver.get("file:///E:/Selenium/example/message.html");
    driver.findElement(By.name("name")).clear();
    driver.findElement(By.name("name")).sendKeys("jack");
    driver.findElement(By.name("e-mail")).clear();
    driver.findElement(By.name("e-mail")).sendKeys("jack@163.com");
    driver.findElement(By.name("comments")).clear();
    driver.findElement(By.name("comments")).sendKeys("Hello,jack!");
    driver.findElement(By.cssSelector("input[type=\"submit\"]")).click();
    assertEquals("留言簿", driver.getTitle());
    assertEquals("完 成", driver.findElement(By.cssSelector("input[type=\"submit

\"]")).getAttribute("value"));
  }

  @After
  public void tearDown() throws Exception {
    driver.quit();
    String verificationErrorString = verificationErrors.toString();
    if (!"".equals(verificationErrorString)) {
      fail(verificationErrorString);
    }
  }

  private boolean isElementPresent(By by) {
    try {
      driver.findElement(by);
      return true;
    } catch (NoSuchElementException e) {
      return false;
    }
  }

  private boolean isAlertPresent() {
    try {
      driver.switchTo().alert();
      return true;
    } catch (NoAlertPresentException e) {
      return false;
    }
  }

  private String closeAlertAndGetItsText() {
    try {
      Alert alert = driver.switchTo().alert();
      String alertText = alert.getText();
      if (acceptNextAlert) {
        alert.accept();
      } else {
        alert.dismiss();
      }
      return alertText;
    } finally {
      acceptNextAlert = true;
    }
  }
}
</pre><div class="sh_sourceCode snippet-hide"><pre><a href="http://tts.tmooc.cn/ttsPage/TESTING/TSDTN201801/SELENIUM/DAY04/CASE/01/index.html#" class="snippet-revealed snippet-toggle sh_url">隐藏</a></pre></div></div><div class="snippet-reveal sh_acid snippet-wrap"><pre class="sh_sourceCode"><a href="http://tts.tmooc.cn/ttsPage/TESTING/TSDTN201801/SELENIUM/DAY04/CASE/01/index.html#" class="snippet-toggle sh_url">代码</a></pre></div></div>
      <a name="case3">
      </a>
      <h2>3 ECShop前台搜索</h2>
      <h3>3.1 问题</h3>
      <p>书写代码创建JUnit测试用例，启动Firefox浏览器，对ECShop前台首页中完成如下操作步骤后，再关闭浏览器。</p>
      <p>（1）id定位输入搜索关键字”索爱”；</p>
      <p>（2）name定位点击”搜索”；</p>
      <p>（3）linkText定位点击“索爱C702c”；</p>
      <p>（4）partialLinkText定位点击“您的购物车中有……”；</p>
      <p>（5）tagName定位点击左上角的“ECSHOP”图标回到首页。</p>
      <h3>3.2 方案</h3>
      <p>本案例需要自己书写代码完成JUnit测试用例。</p>
      <p>首先，需要创建JUnit 4的测试用例类，创建时同时生成setUp和tearDown方法。	其次，在JUnit测试用例类中创建一个测试方法；在setUp方法中启动Firefox浏览器；在测试方法中书写代码打开ECShop前台首页。</p>
      <p>然后，需要在自己手工启动的Firefox浏览器中打开ECShop首页，对每个步骤中关心的页面元素借助于Firebug工具查看页面源代码，依次观察是否有id属性、name属性、class属性，判断是否是链接页面元素，没有这些属性时考虑使用标签名称定位。</p>
      <p>在测试方法中书写代码使用相应定位的方法定位到该元素，并且对其做对应操作；在tearDown方法中退出浏览器。</p>
      <p>最后，需要运行整个JUnit测试用例或来查看结果。</p>
      <h3>3.3 步骤</h3>
      <p>实现此案例需要按照如下步骤进行。</p>
      <p class="number">步骤一：创建新的JUnit测试用例类</p>
      <p>在Project1的day04的package下，使用右键菜单中的new-&gt;Other-&gt;JUnit Test Case来创建新的测试用例类，点击“Next”，如下图-6所示：</p>
      <div class="image">
        <img src="./TEST SELENIUM DAY04_w_files/image006.png">
        <p>图 - 6</p>
      </div>
      <p>输入类名Name为TestECShopSearch1，勾选“setUp”和“tearDown”的两个复选框，点击”Finish“按钮，如下图-7所示：</p>
      <div class="image">
        <img src="./TEST SELENIUM DAY04_w_files/image007.png">
        <p>图 - 7</p>
      </div>
      <p>TestECShopSearch1.java的代码如下所示：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/TESTING/TSDTN201801/SELENIUM/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/TESTING/TSDTN201801/SELENIUM/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/TESTING/TSDTN201801/SELENIUM/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li>package day04<span class="sh_symbol">;</span></li><li><span style="display:none;">&nbsp;</span></li><li><span style="display:none;">&nbsp;</span></li><li>import org<span class="sh_symbol">.</span>junit<span class="sh_symbol">.</span>After<span class="sh_symbol">;</span></li><li>import org<span class="sh_symbol">.</span>junit<span class="sh_symbol">.</span>Before<span class="sh_symbol">;</span></li><li><span style="display:none;">&nbsp;</span></li><li><span class="sh_keyword">public</span> <span class="sh_keyword">class</span> TestECShopSearch1 <span class="sh_cbracket">{</span></li><li><span style="display:none;">&nbsp;</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;@Before</li><li>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_keyword">public</span> void <span class="sh_function">setUp</span><span class="sh_symbol">()</span> <span class="sh_keyword">throws</span> Exception <span class="sh_cbracket">{</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_cbracket">}</span></li><li><span style="display:none;">&nbsp;</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;@After</li><li>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_keyword">public</span> void <span class="sh_function">tearDown</span><span class="sh_symbol">()</span> <span class="sh_keyword">throws</span> Exception <span class="sh_cbracket">{</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_cbracket">}</span></li><li><span style="display:none;">&nbsp;</span></li><li><span class="sh_cbracket">}</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">package day04;


import org.junit.After;
import org.junit.Before;

public class TestECShopSearch1 {

	@Before
	public void setUp() throws Exception {
	}

	@After
	public void tearDown() throws Exception {
	}

}
</pre></div></div>
      <p class="number">步骤二：完成启动和关闭浏览器</p>
      <p>书写代码创建新的测试方法，注解为@Test，并且导入org.junit包下的Test类；书写代码准备driver变量，并且分别在setUp和tearDown方法中书写启动和关闭浏览器的步骤；在测试方法中，书写打开ECShop前台首页的地址的步骤。</p>
      <p>注意：Firefox浏览器需要安装在默认路径下。如果Firefox未安装在默认路径下，需要在driver = new FirefoxDriver();的代码前增加一行代码设置系统属性webdriver.firefox.bin的值为Firefox的启动文件位置，示例如下：</p>
      <p>System.setProperty("webdriver.firefox.bin","D:\\Program Files\\Mozilla Firefox\\firefox.exe");</p>
      <p>TestECShopSearch1.java的代码如下所示：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/TESTING/TSDTN201801/SELENIUM/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/TESTING/TSDTN201801/SELENIUM/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/TESTING/TSDTN201801/SELENIUM/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li>package day04<span class="sh_symbol">;</span></li><li><span style="display:none;">&nbsp;</span></li><li><span style="display:none;">&nbsp;</span></li><li>import org<span class="sh_symbol">.</span>junit<span class="sh_symbol">.</span>After<span class="sh_symbol">;</span></li><li>import org<span class="sh_symbol">.</span>junit<span class="sh_symbol">.</span>Before<span class="sh_symbol">;</span></li><li class="bold_code">import org<span class="sh_symbol">.</span>junit<span class="sh_symbol">.</span>Test<span class="sh_symbol">;</span></li><li class="bold_code">import org<span class="sh_symbol">.</span>openqa<span class="sh_symbol">.</span>selenium<span class="sh_symbol">.</span>WebDriver<span class="sh_symbol">;</span></li><li class="bold_code">import org<span class="sh_symbol">.</span>openqa<span class="sh_symbol">.</span>selenium<span class="sh_symbol">.</span>firefox<span class="sh_symbol">.</span>FirefoxDriver<span class="sh_symbol">;</span></li><li><span style="display:none;">&nbsp;</span></li><li><span class="sh_keyword">public</span> <span class="sh_keyword">class</span> TestECShopSearch1 <span class="sh_cbracket">{</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;@Before</li><li>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_keyword">public</span> void <span class="sh_function">setUp</span><span class="sh_symbol">()</span> <span class="sh_keyword">throws</span> Exception <span class="sh_cbracket">{</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_cbracket">}</span></li><li><span style="display:none;">&nbsp;</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;@After</li><li>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_keyword">public</span> void <span class="sh_function">tearDown</span><span class="sh_symbol">()</span> <span class="sh_keyword">throws</span> Exception <span class="sh_cbracket">{</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_cbracket">}</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="bold_code">&nbsp;&nbsp;&nbsp;&nbsp;@Test</li><li class="bold_code">&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_keyword">public</span> void <span class="sh_function">testa</span><span class="sh_symbol">()</span> <span class="sh_keyword">throws</span> Exception <span class="sh_cbracket">{</span></li><li class="bold_code">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//打开ECShop前台首页</span></li><li class="bold_code">driver<span class="sh_symbol">.</span><span class="sh_function">get</span><span class="sh_symbol">(</span><span class="sh_string">"http://localhost/ws/ecshop/upload/index.php"</span><span class="sh_symbol">);</span></li><li class="bold_code">&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_cbracket">}</span></li><li><span class="sh_cbracket">}</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">package day04;


import org.junit.After;
import org.junit.Before;
#cold_boldimport org.junit.Test;
#cold_boldimport org.openqa.selenium.WebDriver;
#cold_boldimport org.openqa.selenium.firefox.FirefoxDriver;

public class TestECShopSearch1 {
	@Before
	public void setUp() throws Exception {
	}

	@After
	public void tearDown() throws Exception {
	}
	
#cold_bold	@Test
#cold_bold	public void testa() throws Exception {
#cold_bold		//打开ECShop前台首页
#cold_bolddriver.get("http://localhost/ws/ecshop/upload/index.php");
#cold_bold	}
}
</pre></div></div>
      <p class="number">步骤三：实现测试方法</p>
      <p>手工启动Firefox浏览器，打开ECShop首页</p>
      <p>（1）在第一个步骤的页面元素“关键字”文本框中，点击右键，选择“使用Firebug查看元素”，如下图-8所示：</p>
      <div class="image">
        <img src="./TEST SELENIUM DAY04_w_files/image008.png">
        <p>图 - 8</p>
      </div>
      <p>观察Firebug的页面源代码中高亮的行，如下图-9所示：</p>
      <div class="image">
        <img src="./TEST SELENIUM DAY04_w_files/image009.png">
        <p>图 - 9</p>
      </div>
      <p>经过多次使用F5快捷键刷新网页的调查，发现“关键字”文本框存在非动态变化的id属性，id属性的值为”keyword”，从界面源码中将该值复制到剪切板。</p>
      <p>在测试方法中，书写向关键字文本框中输入”索爱“的步骤，代码如下所示：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/TESTING/TSDTN201801/SELENIUM/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/TESTING/TSDTN201801/SELENIUM/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/TESTING/TSDTN201801/SELENIUM/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li>package day04<span class="sh_symbol">;</span></li><li><span style="display:none;">&nbsp;</span></li><li><span style="display:none;">&nbsp;</span></li><li>import org<span class="sh_symbol">.</span>junit<span class="sh_symbol">.</span>After<span class="sh_symbol">;</span></li><li>import org<span class="sh_symbol">.</span>junit<span class="sh_symbol">.</span>Before<span class="sh_symbol">;</span></li><li>import org<span class="sh_symbol">.</span>junit<span class="sh_symbol">.</span>Test<span class="sh_symbol">;</span></li><li class="bold_code">import org<span class="sh_symbol">.</span>openqa<span class="sh_symbol">.</span>selenium<span class="sh_symbol">.</span>By<span class="sh_symbol">;</span></li><li>import org<span class="sh_symbol">.</span>openqa<span class="sh_symbol">.</span>selenium<span class="sh_symbol">.</span>WebDriver<span class="sh_symbol">;</span></li><li>import org<span class="sh_symbol">.</span>openqa<span class="sh_symbol">.</span>selenium<span class="sh_symbol">.</span>firefox<span class="sh_symbol">.</span>FirefoxDriver<span class="sh_symbol">;</span></li><li><span style="display:none;">&nbsp;</span></li><li><span class="sh_keyword">public</span> <span class="sh_keyword">class</span> TestECShopSearch1 <span class="sh_cbracket">{</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;WebDriver driver<span class="sh_symbol">;</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;@Before</li><li>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_keyword">public</span> void <span class="sh_function">setUp</span><span class="sh_symbol">()</span> <span class="sh_keyword">throws</span> Exception <span class="sh_cbracket">{</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//启动Firefox</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;driver <span class="sh_symbol">=</span> <span class="sh_keyword">new</span> <span class="sh_function">FirefoxDriver</span><span class="sh_symbol">();</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_cbracket">}</span></li><li><span style="display:none;">&nbsp;</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;@After</li><li>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_keyword">public</span> void <span class="sh_function">tearDown</span><span class="sh_symbol">()</span> <span class="sh_keyword">throws</span> Exception <span class="sh_cbracket">{</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//关闭浏览器</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;driver<span class="sh_symbol">.</span><span class="sh_function">quit</span><span class="sh_symbol">();</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_cbracket">}</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;@Test</li><li>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_keyword">public</span> void <span class="sh_function">testa</span><span class="sh_symbol">()</span> <span class="sh_keyword">throws</span> Exception <span class="sh_cbracket">{</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//打开ECShop前台首页</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;driver<span class="sh_symbol">.</span><span class="sh_function">get</span><span class="sh_symbol">(</span><span class="sh_string">"http://localhost/ws/ecshop/upload/index.php"</span><span class="sh_symbol">);</span></li><li class="bold_code">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//向关键字文本框中输入“索爱”</span></li><li class="bold_code">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;driver<span class="sh_symbol">.</span><span class="sh_function">findElement</span><span class="sh_symbol">(</span>By<span class="sh_symbol">.</span><span class="sh_function">id</span><span class="sh_symbol">(</span><span class="sh_string">"keyword"</span><span class="sh_symbol">)).</span><span class="sh_function">sendKeys</span><span class="sh_symbol">(</span><span class="sh_string">"索爱"</span><span class="sh_symbol">);</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_cbracket">}</span></li><li><span class="sh_cbracket">}</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">package day04;


import org.junit.After;
import org.junit.Before;
import org.junit.Test;
#cold_boldimport org.openqa.selenium.By;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.firefox.FirefoxDriver;

public class TestECShopSearch1 {
	WebDriver driver;
	@Before
	public void setUp() throws Exception {
		//启动Firefox
		driver = new FirefoxDriver();
	}

	@After
	public void tearDown() throws Exception {
		//关闭浏览器
		driver.quit();
	}
	
	@Test
	public void testa() throws Exception {
		//打开ECShop前台首页
		driver.get("http://localhost/ws/ecshop/upload/index.php");
#cold_bold		//向关键字文本框中输入“索爱”
#cold_bold		driver.findElement(By.id("keyword")).sendKeys("索爱");
	}
}
</pre></div></div>
      <p>（2）在第二个步骤的页面元素“搜索”按钮上，点击右键，选择“使用Firebug查看元素”，如下图-10所示：</p>
      <div class="image">
        <img src="./TEST SELENIUM DAY04_w_files/image010.png">
        <p>图 - 10</p>
      </div>
      <p>观察Firebug的页面源代码中高亮的行，如下图-11所示：</p>
      <div class="image">
        <img src="./TEST SELENIUM DAY04_w_files/image011.png">
        <p>图 - 11</p>
      </div>
      <p>没有id属性，但是存在name属性，name属性的值为”imageField”，从界面源码中将该值复制到剪切板。</p>
      <p>在测试方法中，在输入关键字的步骤后，书写点击”搜索“按钮的步骤，考虑搜索后需要等待，再书写等待5秒的步骤，代码如下所示：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/TESTING/TSDTN201801/SELENIUM/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/TESTING/TSDTN201801/SELENIUM/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/TESTING/TSDTN201801/SELENIUM/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li>package day04<span class="sh_symbol">;</span></li><li><span style="display:none;">&nbsp;</span></li><li><span style="display:none;">&nbsp;</span></li><li>import org<span class="sh_symbol">.</span>junit<span class="sh_symbol">.</span>After<span class="sh_symbol">;</span></li><li>import org<span class="sh_symbol">.</span>junit<span class="sh_symbol">.</span>Before<span class="sh_symbol">;</span></li><li>import org<span class="sh_symbol">.</span>junit<span class="sh_symbol">.</span>Test<span class="sh_symbol">;</span></li><li>import org<span class="sh_symbol">.</span>openqa<span class="sh_symbol">.</span>selenium<span class="sh_symbol">.</span>By<span class="sh_symbol">;</span></li><li>import org<span class="sh_symbol">.</span>openqa<span class="sh_symbol">.</span>selenium<span class="sh_symbol">.</span>WebDriver<span class="sh_symbol">;</span></li><li>import org<span class="sh_symbol">.</span>openqa<span class="sh_symbol">.</span>selenium<span class="sh_symbol">.</span>firefox<span class="sh_symbol">.</span>FirefoxDriver<span class="sh_symbol">;</span></li><li><span style="display:none;">&nbsp;</span></li><li><span class="sh_keyword">public</span> <span class="sh_keyword">class</span> TestECShopSearch1 <span class="sh_cbracket">{</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;WebDriver driver<span class="sh_symbol">;</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;@Before</li><li>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_keyword">public</span> void <span class="sh_function">setUp</span><span class="sh_symbol">()</span> <span class="sh_keyword">throws</span> Exception <span class="sh_cbracket">{</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//启动Firefox</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;driver <span class="sh_symbol">=</span> <span class="sh_keyword">new</span> <span class="sh_function">FirefoxDriver</span><span class="sh_symbol">();</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_cbracket">}</span></li><li><span style="display:none;">&nbsp;</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;@After</li><li>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_keyword">public</span> void <span class="sh_function">tearDown</span><span class="sh_symbol">()</span> <span class="sh_keyword">throws</span> Exception <span class="sh_cbracket">{</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//关闭浏览器</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;driver<span class="sh_symbol">.</span><span class="sh_function">quit</span><span class="sh_symbol">();</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_cbracket">}</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;@Test</li><li>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_keyword">public</span> void <span class="sh_function">testa</span><span class="sh_symbol">()</span> <span class="sh_keyword">throws</span> Exception <span class="sh_cbracket">{</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//打开ECShop前台首页a</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;driver<span class="sh_symbol">.</span><span class="sh_function">get</span><span class="sh_symbol">(</span><span class="sh_string">"http://localhost/ws/ecshop/upload/index.php"</span><span class="sh_symbol">);</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//向关键字文本框中输入“索爱”</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;driver<span class="sh_symbol">.</span><span class="sh_function">findElement</span><span class="sh_symbol">(</span>By<span class="sh_symbol">.</span><span class="sh_function">id</span><span class="sh_symbol">(</span><span class="sh_string">"keyword"</span><span class="sh_symbol">)).</span><span class="sh_function">sendKeys</span><span class="sh_symbol">(</span><span class="sh_string">"索爱"</span><span class="sh_symbol">);</span></li><li class="bold_code">&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//点击“搜索”</span></li><li class="bold_code">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;driver<span class="sh_symbol">.</span><span class="sh_function">findElement</span><span class="sh_symbol">(</span>By<span class="sh_symbol">.</span><span class="sh_function">name</span><span class="sh_symbol">(</span><span class="sh_string">"imageField"</span><span class="sh_symbol">)).</span><span class="sh_function">click</span><span class="sh_symbol">();</span></li><li class="bold_code">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//等待5秒</span></li><li class="bold_code">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Thread<span class="sh_symbol">.</span><span class="sh_function">sleep</span><span class="sh_symbol">(</span><span class="sh_number">5000</span><span class="sh_symbol">);</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_cbracket">}</span></li><li><span class="sh_cbracket">}</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">package day04;


import org.junit.After;
import org.junit.Before;
import org.junit.Test;
import org.openqa.selenium.By;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.firefox.FirefoxDriver;

public class TestECShopSearch1 {
	WebDriver driver;
	@Before
	public void setUp() throws Exception {
		//启动Firefox
		driver = new FirefoxDriver();
	}

	@After
	public void tearDown() throws Exception {
		//关闭浏览器
		driver.quit();
	}
	
	@Test
	public void testa() throws Exception {
		//打开ECShop前台首页a
		driver.get("http://localhost/ws/ecshop/upload/index.php");
		//向关键字文本框中输入“索爱”
		driver.findElement(By.id("keyword")).sendKeys("索爱");
#cold_bold	//点击“搜索”
#cold_bold		driver.findElement(By.name("imageField")).click();
#cold_bold		//等待5秒
#cold_bold		Thread.sleep(5000);
	}
}
</pre></div></div>
      <p>（3）在自己手工启动的Firefox中按照前两步操作后，在第三个步骤的页面元素“索爱C702c”的链接中，点击右键，选择“使用Firebug查看元素”，如下图-12所示：</p>
      <div class="image">
        <img src="./TEST SELENIUM DAY04_w_files/image012.png">
        <p>图 - 12</p>
      </div>
      <p>观察Firebug的页面源代码中高亮的行，如下图-13所示：</p>
      <div class="image">
        <img src="./TEST SELENIUM DAY04_w_files/image013.png">
        <p>图 - 13</p>
      </div>
      <p>没有id属性，也没有name属性，但是这是一个标签名称为a的页面元素，并且在&lt;a&gt;和&lt;/a&gt;之间是纯文本”索爱C702c”，考虑使用linkText定位，从界面源码中将该纯文本值复制到剪切板。</p>
      <p>在测试方法中，书写点击”索爱C702c“的步骤，考虑搜索后需要等待，再书写等待5秒的步骤，代码如下所示：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/TESTING/TSDTN201801/SELENIUM/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/TESTING/TSDTN201801/SELENIUM/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/TESTING/TSDTN201801/SELENIUM/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li>package day04<span class="sh_symbol">;</span></li><li><span style="display:none;">&nbsp;</span></li><li><span style="display:none;">&nbsp;</span></li><li>import org<span class="sh_symbol">.</span>junit<span class="sh_symbol">.</span>After<span class="sh_symbol">;</span></li><li>import org<span class="sh_symbol">.</span>junit<span class="sh_symbol">.</span>Before<span class="sh_symbol">;</span></li><li>import org<span class="sh_symbol">.</span>junit<span class="sh_symbol">.</span>Test<span class="sh_symbol">;</span></li><li>import org<span class="sh_symbol">.</span>openqa<span class="sh_symbol">.</span>selenium<span class="sh_symbol">.</span>By<span class="sh_symbol">;</span></li><li>import org<span class="sh_symbol">.</span>openqa<span class="sh_symbol">.</span>selenium<span class="sh_symbol">.</span>WebDriver<span class="sh_symbol">;</span></li><li>import org<span class="sh_symbol">.</span>openqa<span class="sh_symbol">.</span>selenium<span class="sh_symbol">.</span>firefox<span class="sh_symbol">.</span>FirefoxDriver<span class="sh_symbol">;</span></li><li><span style="display:none;">&nbsp;</span></li><li><span class="sh_keyword">public</span> <span class="sh_keyword">class</span> TestECShopSearch1 <span class="sh_cbracket">{</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;WebDriver driver<span class="sh_symbol">;</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;@Before</li><li>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_keyword">public</span> void <span class="sh_function">setUp</span><span class="sh_symbol">()</span> <span class="sh_keyword">throws</span> Exception <span class="sh_cbracket">{</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//启动Firefox</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;driver <span class="sh_symbol">=</span> <span class="sh_keyword">new</span> <span class="sh_function">FirefoxDriver</span><span class="sh_symbol">();</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_cbracket">}</span></li><li><span style="display:none;">&nbsp;</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;@After</li><li>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_keyword">public</span> void <span class="sh_function">tearDown</span><span class="sh_symbol">()</span> <span class="sh_keyword">throws</span> Exception <span class="sh_cbracket">{</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//关闭浏览器</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;driver<span class="sh_symbol">.</span><span class="sh_function">quit</span><span class="sh_symbol">();</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_cbracket">}</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;@Test</li><li>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_keyword">public</span> void <span class="sh_function">testa</span><span class="sh_symbol">()</span> <span class="sh_keyword">throws</span> Exception <span class="sh_cbracket">{</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//打开ECShop前台首页a</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;driver<span class="sh_symbol">.</span><span class="sh_function">get</span><span class="sh_symbol">(</span><span class="sh_string">"http://localhost/ws/ecshop/upload/index.php"</span><span class="sh_symbol">);</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//向关键字文本框中输入“索爱”</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;driver<span class="sh_symbol">.</span><span class="sh_function">findElement</span><span class="sh_symbol">(</span>By<span class="sh_symbol">.</span><span class="sh_function">id</span><span class="sh_symbol">(</span><span class="sh_string">"keyword"</span><span class="sh_symbol">)).</span><span class="sh_function">sendKeys</span><span class="sh_symbol">(</span><span class="sh_string">"索爱"</span><span class="sh_symbol">);</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//点击“搜索”</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;driver<span class="sh_symbol">.</span><span class="sh_function">findElement</span><span class="sh_symbol">(</span>By<span class="sh_symbol">.</span><span class="sh_function">name</span><span class="sh_symbol">(</span><span class="sh_string">"imageField"</span><span class="sh_symbol">)).</span><span class="sh_function">click</span><span class="sh_symbol">();</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//等待5秒</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Thread<span class="sh_symbol">.</span><span class="sh_function">sleep</span><span class="sh_symbol">(</span><span class="sh_number">5000</span><span class="sh_symbol">);</span></li><li class="bold_code">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//点击“索爱C702c”</span></li><li class="bold_code">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;driver<span class="sh_symbol">.</span><span class="sh_function">findElement</span><span class="sh_symbol">(</span>By<span class="sh_symbol">.</span><span class="sh_function">linkText</span><span class="sh_symbol">(</span><span class="sh_string">"索爱C702c"</span><span class="sh_symbol">)).</span><span class="sh_function">click</span><span class="sh_symbol">();</span></li><li class="bold_code">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//等待5秒</span></li><li class="bold_code">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Thread<span class="sh_symbol">.</span><span class="sh_function">sleep</span><span class="sh_symbol">(</span><span class="sh_number">5000</span><span class="sh_symbol">);</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_cbracket">}</span></li><li><span class="sh_cbracket">}</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">package day04;


import org.junit.After;
import org.junit.Before;
import org.junit.Test;
import org.openqa.selenium.By;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.firefox.FirefoxDriver;

public class TestECShopSearch1 {
	WebDriver driver;
	@Before
	public void setUp() throws Exception {
		//启动Firefox
		driver = new FirefoxDriver();
	}

	@After
	public void tearDown() throws Exception {
		//关闭浏览器
		driver.quit();
	}
	
	@Test
	public void testa() throws Exception {
		//打开ECShop前台首页a
		driver.get("http://localhost/ws/ecshop/upload/index.php");
		//向关键字文本框中输入“索爱”
		driver.findElement(By.id("keyword")).sendKeys("索爱");
		//点击“搜索”
		driver.findElement(By.name("imageField")).click();
		//等待5秒
		Thread.sleep(5000);
#cold_bold		//点击“索爱C702c”
#cold_bold		driver.findElement(By.linkText("索爱C702c")).click();
#cold_bold		//等待5秒
#cold_bold		Thread.sleep(5000);
	}
}
</pre></div></div>
      <p>（4）在自己启动的Firefox浏览器中，手工点击”索爱C702c“，在第四个步骤的页面元素“您的购物车中有……”链接中，点击右键，选择“使用Firebug查看元素”，如下图-14所示：</p>
      <div class="image">
        <img src="./TEST SELENIUM DAY04_w_files/image014.png">
        <p>图 - 14</p>
      </div>
      <p>观察Firebug的页面源代码中高亮的行，如下图-15所示：</p>
      <div class="image">
        <img src="./TEST SELENIUM DAY04_w_files/image015.png">
        <p>图 - 15</p>
      </div>
      <p>没有id属性，也没有name属性，但是这是一个标签名称为a的页面元素，并且在&lt;a&gt;和&lt;/a&gt;之间是纯文本”您的购物车中有 0 件商品，总计金额 ￥0.00元。”，考虑使用linkText定位时参数的长度太长，并且商品件数和金额可能会下次发生变化，所以建议使用partialLinkText使用关键文本”您的购物车中有“来定位，从界面源码中将该纯文本值复制到剪切板。</p>
      <p>在测试方法中，书写点击关键文本是”您的购物车中有“链接的步骤，考虑搜索后需要等待，再书写等待5秒的步骤，代码如下所示：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/TESTING/TSDTN201801/SELENIUM/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/TESTING/TSDTN201801/SELENIUM/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/TESTING/TSDTN201801/SELENIUM/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li>package day04<span class="sh_symbol">;</span></li><li><span style="display:none;">&nbsp;</span></li><li><span style="display:none;">&nbsp;</span></li><li>import org<span class="sh_symbol">.</span>junit<span class="sh_symbol">.</span>After<span class="sh_symbol">;</span></li><li>import org<span class="sh_symbol">.</span>junit<span class="sh_symbol">.</span>Before<span class="sh_symbol">;</span></li><li>import org<span class="sh_symbol">.</span>junit<span class="sh_symbol">.</span>Test<span class="sh_symbol">;</span></li><li>import org<span class="sh_symbol">.</span>openqa<span class="sh_symbol">.</span>selenium<span class="sh_symbol">.</span>By<span class="sh_symbol">;</span></li><li>import org<span class="sh_symbol">.</span>openqa<span class="sh_symbol">.</span>selenium<span class="sh_symbol">.</span>WebDriver<span class="sh_symbol">;</span></li><li>import org<span class="sh_symbol">.</span>openqa<span class="sh_symbol">.</span>selenium<span class="sh_symbol">.</span>firefox<span class="sh_symbol">.</span>FirefoxDriver<span class="sh_symbol">;</span></li><li><span style="display:none;">&nbsp;</span></li><li><span class="sh_keyword">public</span> <span class="sh_keyword">class</span> TestECShopSearch1 <span class="sh_cbracket">{</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;WebDriver driver<span class="sh_symbol">;</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;@Before</li><li>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_keyword">public</span> void <span class="sh_function">setUp</span><span class="sh_symbol">()</span> <span class="sh_keyword">throws</span> Exception <span class="sh_cbracket">{</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//启动Firefox</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;driver <span class="sh_symbol">=</span> <span class="sh_keyword">new</span> <span class="sh_function">FirefoxDriver</span><span class="sh_symbol">();</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_cbracket">}</span></li><li><span style="display:none;">&nbsp;</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;@After</li><li>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_keyword">public</span> void <span class="sh_function">tearDown</span><span class="sh_symbol">()</span> <span class="sh_keyword">throws</span> Exception <span class="sh_cbracket">{</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//关闭浏览器</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;driver<span class="sh_symbol">.</span><span class="sh_function">quit</span><span class="sh_symbol">();</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_cbracket">}</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;@Test</li><li>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_keyword">public</span> void <span class="sh_function">testa</span><span class="sh_symbol">()</span> <span class="sh_keyword">throws</span> Exception <span class="sh_cbracket">{</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//打开ECShop前台首页a</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;driver<span class="sh_symbol">.</span><span class="sh_function">get</span><span class="sh_symbol">(</span><span class="sh_string">"http://localhost/ws/ecshop/upload/index.php"</span><span class="sh_symbol">);</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//向关键字文本框中输入“索爱”</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;driver<span class="sh_symbol">.</span><span class="sh_function">findElement</span><span class="sh_symbol">(</span>By<span class="sh_symbol">.</span><span class="sh_function">id</span><span class="sh_symbol">(</span><span class="sh_string">"keyword"</span><span class="sh_symbol">)).</span><span class="sh_function">sendKeys</span><span class="sh_symbol">(</span><span class="sh_string">"索爱"</span><span class="sh_symbol">);</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//点击“搜索”</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;driver<span class="sh_symbol">.</span><span class="sh_function">findElement</span><span class="sh_symbol">(</span>By<span class="sh_symbol">.</span><span class="sh_function">name</span><span class="sh_symbol">(</span><span class="sh_string">"imageField"</span><span class="sh_symbol">)).</span><span class="sh_function">click</span><span class="sh_symbol">();</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//等待5秒</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Thread<span class="sh_symbol">.</span><span class="sh_function">sleep</span><span class="sh_symbol">(</span><span class="sh_number">5000</span><span class="sh_symbol">);</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//点击“索爱C702c”</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;driver<span class="sh_symbol">.</span><span class="sh_function">findElement</span><span class="sh_symbol">(</span>By<span class="sh_symbol">.</span><span class="sh_function">linkText</span><span class="sh_symbol">(</span><span class="sh_string">"索爱C702c"</span><span class="sh_symbol">)).</span><span class="sh_function">click</span><span class="sh_symbol">();</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//等待5秒</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Thread<span class="sh_symbol">.</span><span class="sh_function">sleep</span><span class="sh_symbol">(</span><span class="sh_number">5000</span><span class="sh_symbol">);</span></li><li class="bold_code">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//点击包含“您的购物车中有”的链接</span></li><li class="bold_code">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;driver<span class="sh_symbol">.</span><span class="sh_function">findElement</span><span class="sh_symbol">(</span>By<span class="sh_symbol">.</span><span class="sh_function">partialLinkText</span><span class="sh_symbol">(</span><span class="sh_string">"您的购物车中有"</span><span class="sh_symbol">)).</span><span class="sh_function">click</span><span class="sh_symbol">();</span></li><li class="bold_code">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//等待5秒</span></li><li class="bold_code">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Thread<span class="sh_symbol">.</span><span class="sh_function">sleep</span><span class="sh_symbol">(</span><span class="sh_number">5000</span><span class="sh_symbol">);</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_cbracket">}</span></li><li><span class="sh_cbracket">}</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">package day04;


import org.junit.After;
import org.junit.Before;
import org.junit.Test;
import org.openqa.selenium.By;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.firefox.FirefoxDriver;

public class TestECShopSearch1 {
	WebDriver driver;
	@Before
	public void setUp() throws Exception {
		//启动Firefox
		driver = new FirefoxDriver();
	}

	@After
	public void tearDown() throws Exception {
		//关闭浏览器
		driver.quit();
	}
	
	@Test
	public void testa() throws Exception {
		//打开ECShop前台首页a
		driver.get("http://localhost/ws/ecshop/upload/index.php");
		//向关键字文本框中输入“索爱”
		driver.findElement(By.id("keyword")).sendKeys("索爱");
		//点击“搜索”
		driver.findElement(By.name("imageField")).click();
		//等待5秒
		Thread.sleep(5000);
		//点击“索爱C702c”
		driver.findElement(By.linkText("索爱C702c")).click();
		//等待5秒
		Thread.sleep(5000);
#cold_bold		//点击包含“您的购物车中有”的链接
#cold_bold		driver.findElement(By.partialLinkText("您的购物车中有")).click();
#cold_bold		//等待5秒
#cold_bold		Thread.sleep(5000);
	}
}
</pre></div></div>
      <p>（5）在自己启动的Firefox浏览器中，按照前面几个步骤操作后，在第五个步骤的页面元素“ECSHOP”图标中，点击右键，选择“使用Firebug查看元素”，如下图-16所示：</p>
      <div class="image">
        <img src="./TEST SELENIUM DAY04_w_files/image016.png">
        <p>图 - 16</p>
      </div>
      <p>观察Firebug的页面源代码中高亮的行，如下图-17所示：</p>
      <div class="image">
        <img src="./TEST SELENIUM DAY04_w_files/image017.png">
        <p>图 - 17</p>
      </div>
      <p>没有id、name、class属性，也不是&lt;a&gt;标签的元素，因为该控件位于界面左上方，所以使用标签名称来定位，标签名称为”img”（img代表图片）。</p>
      <p>在测试方法中，书写点击”ECSHOP“图标的步骤和等待5秒的步骤，代码如下所示：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/TESTING/TSDTN201801/SELENIUM/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/TESTING/TSDTN201801/SELENIUM/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/TESTING/TSDTN201801/SELENIUM/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li>package day04<span class="sh_symbol">;</span></li><li><span style="display:none;">&nbsp;</span></li><li><span style="display:none;">&nbsp;</span></li><li>import org<span class="sh_symbol">.</span>junit<span class="sh_symbol">.</span>After<span class="sh_symbol">;</span></li><li>import org<span class="sh_symbol">.</span>junit<span class="sh_symbol">.</span>Before<span class="sh_symbol">;</span></li><li>import org<span class="sh_symbol">.</span>junit<span class="sh_symbol">.</span>Test<span class="sh_symbol">;</span></li><li>import org<span class="sh_symbol">.</span>openqa<span class="sh_symbol">.</span>selenium<span class="sh_symbol">.</span>By<span class="sh_symbol">;</span></li><li>import org<span class="sh_symbol">.</span>openqa<span class="sh_symbol">.</span>selenium<span class="sh_symbol">.</span>WebDriver<span class="sh_symbol">;</span></li><li>import org<span class="sh_symbol">.</span>openqa<span class="sh_symbol">.</span>selenium<span class="sh_symbol">.</span>firefox<span class="sh_symbol">.</span>FirefoxDriver<span class="sh_symbol">;</span></li><li><span style="display:none;">&nbsp;</span></li><li><span class="sh_keyword">public</span> <span class="sh_keyword">class</span> TestECShopSearch1 <span class="sh_cbracket">{</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;WebDriver driver<span class="sh_symbol">;</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;@Before</li><li>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_keyword">public</span> void <span class="sh_function">setUp</span><span class="sh_symbol">()</span> <span class="sh_keyword">throws</span> Exception <span class="sh_cbracket">{</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//启动Firefox</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;driver <span class="sh_symbol">=</span> <span class="sh_keyword">new</span> <span class="sh_function">FirefoxDriver</span><span class="sh_symbol">();</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_cbracket">}</span></li><li><span style="display:none;">&nbsp;</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;@After</li><li>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_keyword">public</span> void <span class="sh_function">tearDown</span><span class="sh_symbol">()</span> <span class="sh_keyword">throws</span> Exception <span class="sh_cbracket">{</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//关闭浏览器</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;driver<span class="sh_symbol">.</span><span class="sh_function">quit</span><span class="sh_symbol">();</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_cbracket">}</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;@Test</li><li>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_keyword">public</span> void <span class="sh_function">testa</span><span class="sh_symbol">()</span> <span class="sh_keyword">throws</span> Exception <span class="sh_cbracket">{</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//打开ECShop前台首页a</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;driver<span class="sh_symbol">.</span><span class="sh_function">get</span><span class="sh_symbol">(</span><span class="sh_string">"http://localhost/ws/ecshop/upload/index.php"</span><span class="sh_symbol">);</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//向关键字文本框中输入“索爱”</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;driver<span class="sh_symbol">.</span><span class="sh_function">findElement</span><span class="sh_symbol">(</span>By<span class="sh_symbol">.</span><span class="sh_function">id</span><span class="sh_symbol">(</span><span class="sh_string">"keyword"</span><span class="sh_symbol">)).</span><span class="sh_function">sendKeys</span><span class="sh_symbol">(</span><span class="sh_string">"索爱"</span><span class="sh_symbol">);</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//点击“搜索”</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;driver<span class="sh_symbol">.</span><span class="sh_function">findElement</span><span class="sh_symbol">(</span>By<span class="sh_symbol">.</span><span class="sh_function">name</span><span class="sh_symbol">(</span><span class="sh_string">"imageField"</span><span class="sh_symbol">)).</span><span class="sh_function">click</span><span class="sh_symbol">();</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//等待5秒</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Thread<span class="sh_symbol">.</span><span class="sh_function">sleep</span><span class="sh_symbol">(</span><span class="sh_number">5000</span><span class="sh_symbol">);</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//点击“索爱C702c”</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;driver<span class="sh_symbol">.</span><span class="sh_function">findElement</span><span class="sh_symbol">(</span>By<span class="sh_symbol">.</span><span class="sh_function">linkText</span><span class="sh_symbol">(</span><span class="sh_string">"索爱C702c"</span><span class="sh_symbol">)).</span><span class="sh_function">click</span><span class="sh_symbol">();</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//等待5秒</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Thread<span class="sh_symbol">.</span><span class="sh_function">sleep</span><span class="sh_symbol">(</span><span class="sh_number">5000</span><span class="sh_symbol">);</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//点击包含“您的购物车中有”的链接</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;driver<span class="sh_symbol">.</span><span class="sh_function">findElement</span><span class="sh_symbol">(</span>By<span class="sh_symbol">.</span><span class="sh_function">partialLinkText</span><span class="sh_symbol">(</span><span class="sh_string">"您的购物车中有"</span><span class="sh_symbol">)).</span><span class="sh_function">click</span><span class="sh_symbol">();</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//等待5秒</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Thread<span class="sh_symbol">.</span><span class="sh_function">sleep</span><span class="sh_symbol">(</span><span class="sh_number">5000</span><span class="sh_symbol">);</span></li><li class="bold_code"><span class="sh_comment">//点击“ECSHOP”图标回到首页&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class="bold_code">driver<span class="sh_symbol">.</span><span class="sh_function">findElement</span><span class="sh_symbol">(</span>By<span class="sh_symbol">.</span><span class="sh_function">tagName</span><span class="sh_symbol">(</span><span class="sh_string">"img"</span><span class="sh_symbol">)).</span><span class="sh_function">click</span><span class="sh_symbol">();</span></li><li class="bold_code">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//等待5秒</span></li><li class="bold_code">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Thread<span class="sh_symbol">.</span><span class="sh_function">sleep</span><span class="sh_symbol">(</span><span class="sh_number">5000</span><span class="sh_symbol">);</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_cbracket">}</span></li><li><span class="sh_cbracket">}</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">package day04;


import org.junit.After;
import org.junit.Before;
import org.junit.Test;
import org.openqa.selenium.By;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.firefox.FirefoxDriver;

public class TestECShopSearch1 {
	WebDriver driver;
	@Before
	public void setUp() throws Exception {
		//启动Firefox
		driver = new FirefoxDriver();
	}

	@After
	public void tearDown() throws Exception {
		//关闭浏览器
		driver.quit();
	}
	
	@Test
	public void testa() throws Exception {
		//打开ECShop前台首页a
		driver.get("http://localhost/ws/ecshop/upload/index.php");
		//向关键字文本框中输入“索爱”
		driver.findElement(By.id("keyword")).sendKeys("索爱");
		//点击“搜索”
		driver.findElement(By.name("imageField")).click();
		//等待5秒
		Thread.sleep(5000);
		//点击“索爱C702c”
		driver.findElement(By.linkText("索爱C702c")).click();
		//等待5秒
		Thread.sleep(5000);
		//点击包含“您的购物车中有”的链接
		driver.findElement(By.partialLinkText("您的购物车中有")).click();
		//等待5秒
		Thread.sleep(5000);
#cold_bold//点击“ECSHOP”图标回到首页		
#cold_bolddriver.findElement(By.tagName("img")).click();
#cold_bold		//等待5秒
#cold_bold		Thread.sleep(5000);
	}
}
</pre></div></div>
      <p class="number">步骤四：运行调试代码</p>
      <p>在该类上点击右键，选择Run As\JUnit Test来运行JUnit测试用例代码，查看被测系统被启动，并且执行相应的自动化测试步骤。</p>
      <p>查看JUnit视图中的运行状态条，如果为绿色，代表运行成功，如果为红色，需要查看Failure Trace确认和定位问题。</p>
      <h3>3.4 完整代码</h3>
      <p>本案例中，TestECShopSearch1类的完整代码如下所示：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap" style="display: none;"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/TESTING/TSDTN201801/SELENIUM/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/TESTING/TSDTN201801/SELENIUM/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/TESTING/TSDTN201801/SELENIUM/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="hide sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li>package day04<span class="sh_symbol">;</span></li><li><span style="display:none;">&nbsp;</span></li><li><span style="display:none;">&nbsp;</span></li><li>import org<span class="sh_symbol">.</span>junit<span class="sh_symbol">.</span>After<span class="sh_symbol">;</span></li><li>import org<span class="sh_symbol">.</span>junit<span class="sh_symbol">.</span>Before<span class="sh_symbol">;</span></li><li>import org<span class="sh_symbol">.</span>junit<span class="sh_symbol">.</span>Test<span class="sh_symbol">;</span></li><li>import org<span class="sh_symbol">.</span>openqa<span class="sh_symbol">.</span>selenium<span class="sh_symbol">.</span>By<span class="sh_symbol">;</span></li><li>import org<span class="sh_symbol">.</span>openqa<span class="sh_symbol">.</span>selenium<span class="sh_symbol">.</span>WebDriver<span class="sh_symbol">;</span></li><li>import org<span class="sh_symbol">.</span>openqa<span class="sh_symbol">.</span>selenium<span class="sh_symbol">.</span>firefox<span class="sh_symbol">.</span>FirefoxDriver<span class="sh_symbol">;</span></li><li><span style="display:none;">&nbsp;</span></li><li><span class="sh_keyword">public</span> <span class="sh_keyword">class</span> TestECShopSearch1 <span class="sh_cbracket">{</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;WebDriver driver<span class="sh_symbol">;</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;@Before</li><li>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_keyword">public</span> void <span class="sh_function">setUp</span><span class="sh_symbol">()</span> <span class="sh_keyword">throws</span> Exception <span class="sh_cbracket">{</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//启动Firefox</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;driver <span class="sh_symbol">=</span> <span class="sh_keyword">new</span> <span class="sh_function">FirefoxDriver</span><span class="sh_symbol">();</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_cbracket">}</span></li><li><span style="display:none;">&nbsp;</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;@After</li><li>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_keyword">public</span> void <span class="sh_function">tearDown</span><span class="sh_symbol">()</span> <span class="sh_keyword">throws</span> Exception <span class="sh_cbracket">{</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//关闭浏览器</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;driver<span class="sh_symbol">.</span><span class="sh_function">quit</span><span class="sh_symbol">();</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_cbracket">}</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;@Test</li><li>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_keyword">public</span> void <span class="sh_function">testa</span><span class="sh_symbol">()</span> <span class="sh_keyword">throws</span> Exception <span class="sh_cbracket">{</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//打开ECShop前台首页a</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;driver<span class="sh_symbol">.</span><span class="sh_function">get</span><span class="sh_symbol">(</span><span class="sh_string">"http://localhost/ws/ecshop/upload/index.php"</span><span class="sh_symbol">);</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//向关键字文本框中输入“索爱”</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;driver<span class="sh_symbol">.</span><span class="sh_function">findElement</span><span class="sh_symbol">(</span>By<span class="sh_symbol">.</span><span class="sh_function">id</span><span class="sh_symbol">(</span><span class="sh_string">"keyword"</span><span class="sh_symbol">)).</span><span class="sh_function">sendKeys</span><span class="sh_symbol">(</span><span class="sh_string">"索爱"</span><span class="sh_symbol">);</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//点击“搜索”</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;driver<span class="sh_symbol">.</span><span class="sh_function">findElement</span><span class="sh_symbol">(</span>By<span class="sh_symbol">.</span><span class="sh_function">name</span><span class="sh_symbol">(</span><span class="sh_string">"imageField"</span><span class="sh_symbol">)).</span><span class="sh_function">click</span><span class="sh_symbol">();</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//等待5秒</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Thread<span class="sh_symbol">.</span><span class="sh_function">sleep</span><span class="sh_symbol">(</span><span class="sh_number">5000</span><span class="sh_symbol">);</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//点击“索爱C702c”</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;driver<span class="sh_symbol">.</span><span class="sh_function">findElement</span><span class="sh_symbol">(</span>By<span class="sh_symbol">.</span><span class="sh_function">linkText</span><span class="sh_symbol">(</span><span class="sh_string">"索爱C702c"</span><span class="sh_symbol">)).</span><span class="sh_function">click</span><span class="sh_symbol">();</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//等待5秒</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Thread<span class="sh_symbol">.</span><span class="sh_function">sleep</span><span class="sh_symbol">(</span><span class="sh_number">5000</span><span class="sh_symbol">);</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//点击包含“您的购物车中有”的链接</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;driver<span class="sh_symbol">.</span><span class="sh_function">findElement</span><span class="sh_symbol">(</span>By<span class="sh_symbol">.</span><span class="sh_function">partialLinkText</span><span class="sh_symbol">(</span><span class="sh_string">"您的购物车中有"</span><span class="sh_symbol">)).</span><span class="sh_function">click</span><span class="sh_symbol">();</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//等待5秒</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Thread<span class="sh_symbol">.</span><span class="sh_function">sleep</span><span class="sh_symbol">(</span><span class="sh_number">5000</span><span class="sh_symbol">);</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//点击“ECSHOP”图标回到首页</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;driver<span class="sh_symbol">.</span><span class="sh_function">findElement</span><span class="sh_symbol">(</span>By<span class="sh_symbol">.</span><span class="sh_function">tagName</span><span class="sh_symbol">(</span><span class="sh_string">"img"</span><span class="sh_symbol">)).</span><span class="sh_function">click</span><span class="sh_symbol">();</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//等待5秒</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Thread<span class="sh_symbol">.</span><span class="sh_function">sleep</span><span class="sh_symbol">(</span><span class="sh_number">5000</span><span class="sh_symbol">);</span></li><li>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_cbracket">}</span></li><li><span class="sh_cbracket">}</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">package day04;


import org.junit.After;
import org.junit.Before;
import org.junit.Test;
import org.openqa.selenium.By;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.firefox.FirefoxDriver;

public class TestECShopSearch1 {
	WebDriver driver;
	@Before
	public void setUp() throws Exception {
		//启动Firefox
		driver = new FirefoxDriver();
	}

	@After
	public void tearDown() throws Exception {
		//关闭浏览器
		driver.quit();
	}
	
	@Test
	public void testa() throws Exception {
		//打开ECShop前台首页a
		driver.get("http://localhost/ws/ecshop/upload/index.php");
		//向关键字文本框中输入“索爱”
		driver.findElement(By.id("keyword")).sendKeys("索爱");
		//点击“搜索”
		driver.findElement(By.name("imageField")).click();
		//等待5秒
		Thread.sleep(5000);
		//点击“索爱C702c”
		driver.findElement(By.linkText("索爱C702c")).click();
		//等待5秒
		Thread.sleep(5000);
		//点击包含“您的购物车中有”的链接
		driver.findElement(By.partialLinkText("您的购物车中有")).click();
		//等待5秒
		Thread.sleep(5000);
		//点击“ECSHOP”图标回到首页
		driver.findElement(By.tagName("img")).click();
		//等待5秒
		Thread.sleep(5000);
	}
}
</pre><div class="sh_sourceCode snippet-hide"><pre><a href="http://tts.tmooc.cn/ttsPage/TESTING/TSDTN201801/SELENIUM/DAY04/CASE/01/index.html#" class="snippet-revealed snippet-toggle sh_url">隐藏</a></pre></div></div><div class="snippet-reveal sh_acid snippet-wrap"><pre class="sh_sourceCode"><a href="http://tts.tmooc.cn/ttsPage/TESTING/TSDTN201801/SELENIUM/DAY04/CASE/01/index.html#" class="snippet-toggle sh_url">代码</a></pre></div></div>
    </div>
  
</body></html>