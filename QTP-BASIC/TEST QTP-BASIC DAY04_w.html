
<!-- saved from url=(0082)http://tts.tmooc.cn/ttsPage/TESTING/TSDTN201801/QTP-BASIC/DAY04/CASE/01/index.html -->
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>CASE</title>
    
    <script type="text/javascript" src="./TEST QTP-BASIC DAY04_w_files/jquery.min.js">
    </script>
    <script type="text/javascript" src="./TEST QTP-BASIC DAY04_w_files/jquery.snippet.js">
    </script>
    <script type="text/javascript" src="./TEST QTP-BASIC DAY04_w_files/main.js">
    </script>
    <link type="text/css" href="./TEST QTP-BASIC DAY04_w_files/index.css" rel="Stylesheet">
    <link type="text/css" href="./TEST QTP-BASIC DAY04_w_files/jquery.snippet.css" rel="Stylesheet">
  </head>
  <body>
    <div class="source_style_case">
      <a name="page_top_case" id="top_anchor">
      </a><a id="link_top" href="http://tts.tmooc.cn/ttsPage/TESTING/TSDTN201801/QTP-BASIC/DAY04/CASE/01/index.html#page_top_case">Top</a>
      <h1>TEST QTPBASIC DAY04</h1>
      <ol class="index">
        <li>
          <a href="http://tts.tmooc.cn/ttsPage/TESTING/TSDTN201801/QTP-BASIC/DAY04/CASE/01/index.html#case1">两位数加法器多组数据加法</a>
        </li>
        <li>
          <a href="http://tts.tmooc.cn/ttsPage/TESTING/TSDTN201801/QTP-BASIC/DAY04/CASE/01/index.html#case2">Mtours多组用户登录退出</a>
        </li>
        <li>
          <a href="http://tts.tmooc.cn/ttsPage/TESTING/TSDTN201801/QTP-BASIC/DAY04/CASE/01/index.html#case3">两位数加法器多组数据检查结果</a>
        </li>
        <li>
          <a href="http://tts.tmooc.cn/ttsPage/TESTING/TSDTN201801/QTP-BASIC/DAY04/CASE/01/index.html#case4">输出加法计算实际结果</a>
        </li>
      </ol>
      <a name="case1">
      </a>
      <h2>1 两位数加法器多组数据加法</h2>
      <h3>1.1 问题</h3>
      <p>使用多组数据测试两位数加法计算器。</p>
      <h3>1.2 方案</h3>
      <p>录制代码，对“第一个数”和“第二个数”做参数化；设置DataTable反复次数为运行所有行。</p>
      <h3>1.3 步骤</h3>
      <p class="number">步骤一：新建脚本，保存脚本</p>
      <p>1、打开QTP，点击菜单“File-&gt;New-&gt;Test”，点击菜单“File-&gt;Save As”：如下图-1所示：</p>
      <div class="image">
        <img src="./TEST QTP-BASIC DAY04_w_files/image001.png">
        <p>图-1</p>
      </div>
      <p>2、在“File Name”中填写脚本名称：两位数加法器-多组数据加法-DataTable参数化-演示，点击“Save”按钮：如下图-2所示：</p>
      <div class="image">
        <img src="./TEST QTP-BASIC DAY04_w_files/image002.png">
        <p>图-2</p>
      </div>
      <p class="number">步骤二：设置被测系统录制和回放模式</p>
      <p>1、点击菜单“Automation-&gt;Record and Run Settings”：如下图-3所示：</p>
      <div class="image">
        <img src="./TEST QTP-BASIC DAY04_w_files/image003.png">
        <p>图-3</p>
      </div>
      <p>2、在“Web”选项卡中点击第一个单选钮，如下图-4所示：</p>
      <div class="image">
        <img src="./TEST QTP-BASIC DAY04_w_files/image004.png">
        <p>图-4</p>
      </div>
      <p>3、在“Windows Applications”选项卡中点击第二个单选钮，再点击“+”按钮：如下图-5所示：</p>
      <div class="image">
        <img src="./TEST QTP-BASIC DAY04_w_files/image005.png">
        <p>图-5</p>
      </div>
      <p>4、点击“…”按钮，找到“两位数加法器.exe”被测系统，点击“OK”按钮：如下图-6所示：</p>
      <div class="image">
        <img src="./TEST QTP-BASIC DAY04_w_files/image006.png">
        <p>图-6</p>
      </div>
      <p>5、点击“确定”按钮（注意：Application details中只有一个被测程序）：如下图-7所示：</p>
      <div class="image">
        <img src="./TEST QTP-BASIC DAY04_w_files/image007.png">
        <p>图-7</p>
      </div>
      <p class="number">步骤三：录制脚本</p>
      <p>1、点击工具栏按钮“Record”：如下图-8所示：</p>
      <div class="image">
        <img src="./TEST QTP-BASIC DAY04_w_files/image008.png">
        <p>图-8</p>
      </div>
      <p>2、录制脚本，步骤如下：“第一个数”输入90，“第二个数”输入50，点击“计算”，再点击“重置”；录制结束后，点击工具栏按钮“Stop”：如下图-9所示：</p>
      <div class="image">
        <img src="./TEST QTP-BASIC DAY04_w_files/image009.png">
        <p>图-9</p>
      </div>
      <p>3、录制后的代码如下图-10所示：</p>
      <div class="image">
        <img src="./TEST QTP-BASIC DAY04_w_files/image010.png">
        <p>图-10</p>
      </div>
      <p class="number">步骤四：参数化“第一个数”</p>
      <p>1、点击“第一个数”输入的数值“90”，再点击文本框中出现的“&lt;#&gt;”按钮：如下图-11所示：</p>
      <div class="image">
        <img src="./TEST QTP-BASIC DAY04_w_files/image011.png">
        <p>图-11</p>
      </div>
      <p>2、在“Value Configuration Options”窗口中，点击第二个单选钮；第一个下拉列表中选择：DataTable，Name中输入：加数1，Location in DataTable选择第一个单选钮；点击“OK”按钮：如下图-12所示：</p>
      <div class="image">
        <img src="./TEST QTP-BASIC DAY04_w_files/image012.png">
        <p>图-12</p>
      </div>
      <p>3、在DataTable中的Global表单中存在新添加的一列“加数1”，有一行默认值90：如下图-13所示：</p>
      <div class="image">
        <img src="./TEST QTP-BASIC DAY04_w_files/image013.png">
        <p>图-13</p>
      </div>
      <p>4、按照用例中“第一个数”的测试数据，将其填写到“加数1”列中：如下图-14所示：</p>
      <div class="image">
        <img src="./TEST QTP-BASIC DAY04_w_files/image014.png">
        <p>图-14</p>
      </div>
      <p>5、参数化后的代码如下图-15所示：</p>
      <div class="image">
        <img src="./TEST QTP-BASIC DAY04_w_files/image015.png">
        <p>图-15</p>
      </div>
      <p class="number">步骤五：参数化“第二个数”</p>
      <p>1、点击“第二个数”输入的数值“50”，再点击文本框中出现的“&lt;#&gt;”按钮：如下图-16所示：</p>
      <div class="image">
        <img src="./TEST QTP-BASIC DAY04_w_files/image016.png">
        <p>图-16</p>
      </div>
      <p>2、在“Value Configuration Options”窗口中，点击第二个单选钮；第一个下拉列表中选择：DataTable，Name中输入：加数2，Location in DataTable选择第一个单选钮；点击“OK”按钮：如下图-17所示：</p>
      <div class="image">
        <img src="./TEST QTP-BASIC DAY04_w_files/image017.png">
        <p>图-17</p>
      </div>
      <p>3、在DataTable中的Global表单中存在新添加的一列“加数2”，有一行默认值50：如下图-18所示：</p>
      <div class="image">
        <img src="./TEST QTP-BASIC DAY04_w_files/image018.png">
        <p>图-18</p>
      </div>
      <p>4、按照用例中“第二个数”的测试数据，将其填写到“加数2”列中：如下图-19所示：</p>
      <div class="image">
        <img src="./TEST QTP-BASIC DAY04_w_files/image019.png">
        <p>图-19</p>
      </div>
      <p>5、参数化后的代码如下图-20所示：</p>
      <div class="image">
        <img src="./TEST QTP-BASIC DAY04_w_files/image020.png">
        <p>图-20</p>
      </div>
      <p class="number">步骤六：设置反复次数</p>
      <p>1、点击菜单“File-&gt;Settings”，如下图-21所示：</p>
      <div class="image">
        <img src="./TEST QTP-BASIC DAY04_w_files/image021.png">
        <p>图-21</p>
      </div>
      <p>2、在“Test Settings”窗口中的左侧点击“Run”；在“DataTable iterations”中选择第二个单选钮；点击“OK”按钮，如下图-22所示：</p>
      <div class="image">
        <img src="./TEST QTP-BASIC DAY04_w_files/image022.png">
        <p>图-22</p>
      </div>
      <p class="number">步骤七：运行脚本</p>
      <p>1、点击工具栏按钮“Run”（注意：运行前，将被测程序都关闭），如下图-23所示：</p>
      <div class="image">
        <img src="./TEST QTP-BASIC DAY04_w_files/image023.png">
        <p>图-23</p>
      </div>
      <p>2、查看结果报告，脚本一共反复4次，如下图-24所示：</p>
      <div class="image">
        <img src="./TEST QTP-BASIC DAY04_w_files/image024.png">
        <p>图-24</p>
      </div>
      <a name="case2">
      </a>
      <h2>2 Mtours多组用户登录退出</h2>
      <h3>2.1 问题</h3>
      <p>使用多组用户测试Mtours系统的登录和退出功能。</p>
      <h3>2.2 方案</h3>
      <p>首先注册3个用户，再录制代码，对“User Name”做参数化；设置DataTable反复次数为运行所有行。</p>
      <h3>2.3 步骤</h3>
      <p class="number">步骤一：注册用户</p>
      <p>1、在Mtours首页点击“REGISTER”按钮，如下图-25所示：</p>
      <div class="image">
        <img src="./TEST QTP-BASIC DAY04_w_files/image025.png">
        <p>图-25</p>
      </div>
      <p>2、输入用户名（User Name：jack）、密码（Password：123）、确认密码（Confirm Password：123），点击“SUBMIT”注册用户，如下图-26所示：</p>
      <div class="image">
        <img src="./TEST QTP-BASIC DAY04_w_files/image026.png">
        <p>图-26</p>
      </div>
      <p>3、用户jack注册成功，如下图-27所示：</p>
      <div class="image">
        <img src="./TEST QTP-BASIC DAY04_w_files/image027.png">
        <p>图-27</p>
      </div>
      <p>4、按照同样的方法，再注册2个用户，分别为：</p>
      <p>User Name：rose；Password：456</p>
      <p>User Name：peter；Password：789</p>
      <p class="number">步骤二：新建脚本，保存脚本</p>
      <p>1、打开QTP，点击菜单“File-&gt;New-&gt;Test”，点击菜单“File-&gt;Save As”：如下图-28所示：</p>
      <div class="image">
        <img src="./TEST QTP-BASIC DAY04_w_files/image028.png">
        <p>图-28</p>
      </div>
      <p>2、在“File Name”中填写脚本名称：Mtours-登录退出-DataTable参数化-演示，点击“Save”按钮：如下图-29所示：</p>
      <div class="image">
        <img src="./TEST QTP-BASIC DAY04_w_files/image029.png">
        <p>图-29</p>
      </div>
      <p class="number">步骤三：设置被测系统录制和回放模式</p>
      <p>1、点击菜单“Automation-&gt;Record and Run Settings”：如下图-30所示：</p>
      <div class="image">
        <img src="./TEST QTP-BASIC DAY04_w_files/image030.png">
        <p>图-30</p>
      </div>
      <p>2、在“Windows Applications”选项卡中点击第一个单选钮，如下图-31所示：</p>
      <div class="image">
        <img src="./TEST QTP-BASIC DAY04_w_files/image031.png">
        <p>图-31</p>
      </div>
      <p>3、在“Web”选项卡中点击第二个单选钮，在第一个下拉列表中输入访问地址：http://localhost:8080/mtours，点击“确定”按钮，如下图-32所示：</p>
      <div class="image">
        <img src="./TEST QTP-BASIC DAY04_w_files/image032.png">
        <p>图-32</p>
      </div>
      <p class="number">步骤四：录制脚本</p>
      <p>1、点击工具栏按钮“Record”：如下图-33所示：</p>
      <div class="image">
        <img src="./TEST QTP-BASIC DAY04_w_files/image033.png">
        <p>图-33</p>
      </div>
      <p>2、录制脚本，步骤如下：手动启动Mtours被测系统，使用用户名jack，密码123登录Mtours，登录成功后，点击“SIGH-OFF”，再点击“HOME”；录制结束后，点击工具栏按钮“Stop”：如下图-34所示：</p>
      <div class="image">
        <img src="./TEST QTP-BASIC DAY04_w_files/image034.png">
        <p>图-34</p>
      </div>
      <p>3、录制后的代码如下图-35所示：</p>
      <div class="image">
        <img src="./TEST QTP-BASIC DAY04_w_files/image035.png">
        <p>图-35</p>
      </div>
      <p class="number">步骤五：参数化用户名“userName”</p>
      <p>1、点击“userName”输入的“jack”，再点击文本框中出现的“&lt;#&gt;”按钮：如下图-36所示：</p>
      <div class="image">
        <img src="./TEST QTP-BASIC DAY04_w_files/image036.png">
        <p>图-36</p>
      </div>
      <p>2、在“Value Configuration Options”窗口中，点击第二个单选钮；第一个下拉列表中选择：DataTable，Name中输入：用户名，Location in DataTable选择第一个单选钮；点击“OK”按钮：如下图-37所示：</p>
      <div class="image">
        <img src="./TEST QTP-BASIC DAY04_w_files/image037.png">
        <p>图-37</p>
      </div>
      <p>3、在DataTable中的Global表单中存在新添加的一列“用户名”，有一行默认值jack：如下图-38所示：</p>
      <div class="image">
        <img src="./TEST QTP-BASIC DAY04_w_files/image038.png">
        <p>图-38</p>
      </div>
      <p>4、按照已经注册过的用户名，将其填写到“用户名”列中：如下图-39所示：</p>
      <div class="image">
        <img src="./TEST QTP-BASIC DAY04_w_files/image039.png">
        <p>图-39</p>
      </div>
      <p>5、参数化后的代码如下图-40所示：</p>
      <div class="image">
        <img src="./TEST QTP-BASIC DAY04_w_files/image040.png">
        <p>图-40</p>
      </div>
      <p class="number">步骤六：参数化密码“password”</p>
      <p>1、点击“password”输入的“5515122bb0…”，再点击文本框中出现的“&lt;#&gt;”按钮：如下图-41所示：</p>
      <div class="image">
        <img src="./TEST QTP-BASIC DAY04_w_files/image041.png">
        <p>图-41</p>
      </div>
      <p>2、在“Value Configuration Options”窗口中，点击第二个单选钮；第一个下拉列表中选择：DataTable，Name中输入：密码，Location in DataTable选择第一个单选钮Global Sheet；点击“OK”按钮：如下图-42所示：</p>
      <div class="image">
        <img src="./TEST QTP-BASIC DAY04_w_files/image042.png">
        <p>图-42</p>
      </div>
      <p>3、在DataTable中的Global表单中存在新添加的一列“密码”，有一行默认值5515122bb0…：如下图-43所示：</p>
      <div class="image">
        <img src="./TEST QTP-BASIC DAY04_w_files/image043.png">
        <p>图-43</p>
      </div>
      <p>4、将代码中的加密方法“SetSecure”改为“Set”，修改后的代码如下图-44所示：</p>
      <div class="image">
        <img src="./TEST QTP-BASIC DAY04_w_files/image044.png">
        <p>图-44</p>
      </div>
      <p>5、首先将jack用户的密码更新成123；再将用户rose和peter两个用户的密码，填写到Global表中“密码”列，如下图-45所示：</p>
      <div class="image">
        <img src="./TEST QTP-BASIC DAY04_w_files/image045.png">
        <p>图-45</p>
      </div>
      <p class="number">步骤七：设置反复次数</p>
      <p>1、点击菜单“File-&gt;Settings”，如下图-46所示：</p>
      <div class="image">
        <img src="./TEST QTP-BASIC DAY04_w_files/image046.png">
        <p>图-46</p>
      </div>
      <p>2、在“Test Settings”窗口中的左侧点击“Run”；在“DataTable iterations”中选择第二个单选钮；点击“OK”按钮，如下图-47所示：</p>
      <div class="image">
        <img src="./TEST QTP-BASIC DAY04_w_files/image047.png">
        <p>图-47</p>
      </div>
      <p class="number">步骤八：运行脚本</p>
      <p>1、点击工具栏按钮“Run”（注意：运行前，将被测程序都关闭），如下图-48所示：</p>
      <div class="image">
        <img src="./TEST QTP-BASIC DAY04_w_files/image048.png">
        <p>图-48</p>
      </div>
      <p>2、查看结果报告，脚本一共反复3次，如下图-49所示：</p>
      <div class="image">
        <img src="./TEST QTP-BASIC DAY04_w_files/image049.png">
        <p>图-49</p>
      </div>
      <a name="case3">
      </a>
      <h2>3 两位数加法器多组数据检查结果</h2>
      <h3>3.1 问题</h3>
      <p>在问题1的基础上，对输出结果做检查点 。</p>
      <h3>3.2 方案</h3>
      <p>在“Active Screen”窗口中，选中“结果”文本框，对计算结果做标准检查点，检查点的预期结果做DataTable参数化。</p>
      <h3>3.3 步骤</h3>
      <p class="number">步骤一：打开问题1的脚本</p>
      <p>1、点击工具栏按钮“Open”，如下图-50所示：</p>
      <div class="image">
        <img src="./TEST QTP-BASIC DAY04_w_files/image050.png">
        <p>图-50</p>
      </div>
      <p>2、在“Open Test”窗口，选择问题1的脚本，点击“Open”按钮，如下图-51所示：</p>
      <div class="image">
        <img src="./TEST QTP-BASIC DAY04_w_files/image051.png">
        <p>图-51</p>
      </div>
      <p>3、打开问题1的脚本，如下图-52所示：</p>
      <div class="image">
        <img src="./TEST QTP-BASIC DAY04_w_files/image052.png">
        <p>图-52</p>
      </div>
      <p class="number">步骤二：对计算结果做检查点参数化</p>
      <p>1、选中点击“计算”按钮代码行，切换到“Active Screen”视图，如下图-53所示：</p>
      <div class="image">
        <img src="./TEST QTP-BASIC DAY04_w_files/image053.png">
        <p>图-53</p>
      </div>
      <p>2、在“结果”文本框中点击鼠标右键，在右键菜单中点击“Insert Standard Checkpoint…”，如下图-54所示：</p>
      <div class="image">
        <img src="./TEST QTP-BASIC DAY04_w_files/image054.png">
        <p>图-54</p>
      </div>
      <p>3、选择对象类型为VbEdit的Text3对象（也就是“结果”文本框），点击“OK”按钮，如下图-55所示：</p>
      <div class="image">
        <img src="./TEST QTP-BASIC DAY04_w_files/image055.png">
        <p>图-55</p>
      </div>
      <p>4、勾选“text”属性，在“Configure Value”分组框中勾选第二个单选钮，再点击后面的“Parameter Options”按钮，修改预期结果保存的位置，如下图-56所示：</p>
      <div class="image">
        <img src="./TEST QTP-BASIC DAY04_w_files/image056.png">
        <p>图-56</p>
      </div>
      <p>5、将预期结果关联到DataTable中的Global表单中的“预期结果”列，点击“OK”按钮，如下图-57所示：</p>
      <div class="image">
        <img src="./TEST QTP-BASIC DAY04_w_files/image057.png">
        <p>图-57</p>
      </div>
      <p>6、查看实际结果保存的位置，在“Insert Statement“中选择第二个单选钮，将检查点插入的位置改为“After current step”（当前步骤之后），Checkpoint timeout（检查点超时时间）为10 seconds（默认），点击“OK“按钮，如下图-58所示：</p>
      <div class="image">
        <img src="./TEST QTP-BASIC DAY04_w_files/image058.png">
        <p>图-58</p>
      </div>
      <p>7、插入的一行代码，和DataTable中添加“预期结果“列，如下图-59所示：</p>
      <div class="image">
        <img src="./TEST QTP-BASIC DAY04_w_files/image059.png">
        <p>图-59</p>
      </div>
      <p>8、填写预期结果，如下图-60所示：</p>
      <div class="image">
        <img src="./TEST QTP-BASIC DAY04_w_files/image060.png">
        <p>图-60</p>
      </div>
      <p class="number">步骤三：运行查看结果</p>
      <p>1、点击工具栏按钮“Run”（注意：运行前，将被测程序都关闭），如下图-61所示：</p>
      <div class="image">
        <img src="./TEST QTP-BASIC DAY04_w_files/image061.png">
        <p>图-61</p>
      </div>
      <p>2、查看结果报告，脚本一共反复4次，并且每次反复检查点都通过，如下图-62所示：</p>
      <div class="image">
        <img src="./TEST QTP-BASIC DAY04_w_files/image062.png">
        <p>图-62</p>
      </div>
      <a name="case4">
      </a>
      <h2>4 输出加法计算实际结果</h2>
      <h3>4.1 问题</h3>
      <p>将两位数加法计算器的结果输出到DataTable中。</p>
      <h3>4.2 方案</h3>
      <p>在“Active Screen”窗口中，选中“结果”文本框，选择“Insert out value“将结果输出到DataTable中。</p>
      <h3>4.3 步骤</h3>
      <p class="number">步骤一：打开问题3的脚本</p>
      <p>1、点击工具栏按钮“Open”，如下图-63所示：</p>
      <div class="image">
        <img src="./TEST QTP-BASIC DAY04_w_files/image063.png">
        <p>图-63</p>
      </div>
      <p>2、在“Open Test”窗口，选择问题2的脚本，点击“Open”按钮，如下图-64所示：</p>
      <div class="image">
        <img src="./TEST QTP-BASIC DAY04_w_files/image064.png">
        <p>图-64</p>
      </div>
      <p>3、打开问题3的脚本，如下图-65所示：</p>
      <div class="image">
        <img src="./TEST QTP-BASIC DAY04_w_files/image065.png">
        <p>图-65</p>
      </div>
      <p class="number">步骤二：对计算结果做检查点参数化</p>
      <p>1、选中点击“计算”按钮代码行，切换到“Active Screen”视图，如下图-66所示：</p>
      <div class="image">
        <img src="./TEST QTP-BASIC DAY04_w_files/image066.png">
        <p>图-66</p>
      </div>
      <p>2、在“结果”文本框中点击鼠标右键，在右键菜单中点击“Insert output value…”，如下图-67所示：</p>
      <div class="image">
        <img src="./TEST QTP-BASIC DAY04_w_files/image067.png">
        <p>图-67</p>
      </div>
      <p>3、选择对象类型为VbEdit的Text3对象（也就是“结果”文本框），点击“OK”按钮，如下图-68所示：</p>
      <div class="image">
        <img src="./TEST QTP-BASIC DAY04_w_files/image068.png">
        <p>图-68</p>
      </div>
      <p>4、勾选“text”属性，点击“Modify“按钮，修改输出结果保存的位置，如下图-69所示：</p>
      <div class="image">
        <img src="./TEST QTP-BASIC DAY04_w_files/image069.png">
        <p>图-69</p>
      </div>
      <p>5、将输出结果保存在DataTable中Global页中的“实际结果“列，点击”OK“按钮，如下图-70所示：</p>
      <div class="image">
        <img src="./TEST QTP-BASIC DAY04_w_files/image070.png">
        <p>图-70</p>
      </div>
      <p>6、确认输出结果保存的位置，在“Insert statement“选择第二个单选钮（将该行代码插入到当前步骤之后），如下图-71所示：</p>
      <div class="image">
        <img src="./TEST QTP-BASIC DAY04_w_files/image071.png">
        <p>图-71</p>
      </div>
      <p>7、插入的一行代码，和DataTable中添加“实际结果“列，如下图-72所示：</p>
      <div class="image">
        <img src="./TEST QTP-BASIC DAY04_w_files/image072.png">
        <p>图-72</p>
      </div>
      <p class="number">步骤三：运行查看结果</p>
      <p>1、点击工具栏按钮“Run”（注意：运行前，将被测程序都关闭），如下图-73所示：</p>
      <div class="image">
        <img src="./TEST QTP-BASIC DAY04_w_files/image073.png">
        <p>图-73</p>
      </div>
      <p>2、查看结果报告，脚本一共反复4次，点击“Run-time DataTable“查看输出的实际结果，如下图-74所示：</p>
      <div class="image">
        <img src="./TEST QTP-BASIC DAY04_w_files/image074.png">
        <p>图-74</p>
      </div>
    </div>
  
</body></html>